<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 15.0.4"/>
    <title>src.algorithmie.simulation API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note{color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.tip{color:#0a3622;background-color:#d1e7dd;border-color:#a3cfbb;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%230a3622%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%206a6%206%200%201%201%2010.174%204.31c-.203.196-.359.4-.453.619l-.762%201.769A.5.5%200%200%201%2010.5%2013a.5.5%200%200%201%200%201%20.5.5%200%200%201%200%201l-.224.447a1%201%200%200%201-.894.553H6.618a1%201%200%200%201-.894-.553L5.5%2015a.5.5%200%200%201%200-1%20.5.5%200%200%201%200-1%20.5.5%200%200%201-.46-.302l-.761-1.77a2%202%200%200%200-.453-.618A5.98%205.98%200%200%201%202%206m6-5a5%205%200%200%200-3.479%208.592c.263.254.514.564.676.941L5.83%2012h4.342l.632-1.467c.162-.377.413-.687.676-.941A5%205%200%200%200%208%201%22/%3E%3C/svg%3E");}.pdoc .alert.important{color:#055160;background-color:#cff4fc;border-color:#9eeaf9;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23055160%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M2%200a2%202%200%200%200-2%202v12a2%202%200%200%200%202%202h12a2%202%200%200%200%202-2V2a2%202%200%200%200-2-2zm6%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.caution{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M11.46.146A.5.5%200%200%200%2011.107%200H4.893a.5.5%200%200%200-.353.146L.146%204.54A.5.5%200%200%200%200%204.893v6.214a.5.5%200%200%200%20.146.353l4.394%204.394a.5.5%200%200%200%20.353.146h6.214a.5.5%200%200%200%20.353-.146l4.394-4.394a.5.5%200%200%200%20.146-.353V4.893a.5.5%200%200%200-.146-.353zM8%204c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%204.995A.905.905%200%200%201%208%204m.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .decorator-deprecated{color:#842029;}.pdoc .decorator-deprecated ~ span{filter:grayscale(1) opacity(0.8);}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../algorithmie.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;src.algorithmie</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="class" href="#Simulation">Simulation</a>
                            <ul class="memberlist">
                        <li>
                                <a class="function" href="#Simulation.__init__">Simulation</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.nb_personnes">nb_personnes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.maladie">maladie</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.liste_personnes">liste_personnes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.df_historique">df_historique</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.iterations">iterations</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.largeur_fenetre">largeur_fenetre</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.hauteur_fenetre">hauteur_fenetre</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.grille">grille</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.iterations_sans_infecte">iterations_sans_infecte</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.duree_cooldown_avant_naissance">duree_cooldown_avant_naissance</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.cooldown_avant_naissance">cooldown_avant_naissance</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.pourcentage_immunodeprimes">pourcentage_immunodeprimes</a>
                        </li>
                        <li>
                                <a class="variable" href="#Simulation.taux_naissance">taux_naissance</a>
                        </li>
                        <li>
                                <a class="function" href="#Simulation.initialiser_population">initialiser_population</a>
                        </li>
                        <li>
                                <a class="function" href="#Simulation.propager_infection">propager_infection</a>
                        </li>
                        <li>
                                <a class="function" href="#Simulation.deplacements_aleatoires">deplacements_aleatoires</a>
                        </li>
                        <li>
                                <a class="function" href="#Simulation.deplacements_grille">deplacements_grille</a>
                        </li>
                        <li>
                                <a class="function" href="#Simulation.deplacement_stochastique_directionnel">deplacement_stochastique_directionnel</a>
                        </li>
                        <li>
                                <a class="function" href="#Simulation.deplacement_boids_simplifie">deplacement_boids_simplifie</a>
                        </li>
                        <li>
                                <a class="function" href="#Simulation.naissance">naissance</a>
                        </li>
                        <li>
                                <a class="function" href="#Simulation.mise_a_jour_iteration">mise_a_jour_iteration</a>
                        </li>
                </ul>

            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
src<wbr>.<a href="./../algorithmie.html">algorithmie</a><wbr>.simulation    </h1>

                
                        <input id="mod-simulation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-simulation-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">  1</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">math</span><span class="w"> </span><span class="kn">import</span> <span class="o">*</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">  2</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">random</span><span class="w"> </span><span class="kn">import</span> <span class="n">uniform</span><span class="p">,</span> <span class="n">randint</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">  3</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">pandas</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">pd</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">  4</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">random</span>
</span><span id="L-5"><a href="#L-5"><span class="linenos">  5</span></a><span class="kn">import</span><span class="w"> </span><span class="nn">math</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">  6</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.grille</span><span class="w"> </span><span class="kn">import</span> <span class="n">Grille</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">  7</span></a><span class="kn">from</span><span class="w"> </span><span class="nn">.personne</span><span class="w"> </span><span class="kn">import</span> <span class="n">Personne</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">  8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">  9</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Simulation</span> <span class="p">:</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos"> 10</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos"> 11</span></a><span class="sd">    On implémente ensuite la classe simulation, qui permet de construire toute la structure pour la simulation.</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos"> 12</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos"> 13</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maladie</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">,</span> <span class="n">duree_cooldown_avant_naissance</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">nb_personnes</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">taux_naissance</span><span class="o">=</span><span class="mf">0.02</span><span class="p">):</span>
</span><span id="L-14"><a href="#L-14"><span class="linenos"> 14</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos"> 15</span></a><span class="sd">        Nb personnes est le nombre de personnes totales dans la simulation, tout état confondu.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos"> 16</span></a><span class="sd">        Maladie est l&#39;objet de classe Maladie que la simulation va répandre.</span>
</span><span id="L-17"><a href="#L-17"><span class="linenos"> 17</span></a><span class="sd">        Liste personnes permet de stocker les personnes de la simulation.</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos"> 18</span></a><span class="sd">        On stocke les statistiques qui peuvent servir pour la réalisation des statistiques dans l&#39;attribut df_historique.</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos"> 19</span></a><span class="sd">        On fait le stockage directement dans un dataframe pour que ce soit plus simple pour la réalisation des schémas matplotlib; car c&#39;est la structure priviligiée pour ça.</span>
</span><span id="L-20"><a href="#L-20"><span class="linenos"> 20</span></a><span class="sd">        Iteration est le numéro de l&#39;itération en cours.</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos"> 21</span></a><span class="sd">        Grille est l&#39;objet de classe Grille associé à la simulation.</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos"> 22</span></a><span class="sd">        Taux naissance représente le pourcentage d&#39;enfants nés dans la population.</span>
</span><span id="L-23"><a href="#L-23"><span class="linenos"> 23</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos"> 24</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nb_personnes</span> <span class="o">=</span> <span class="n">nb_personnes</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos"> 25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span> <span class="o">=</span> <span class="n">maladie</span>
</span><span id="L-26"><a href="#L-26"><span class="linenos"> 26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos"> 27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nb_morts&quot;</span><span class="p">,</span> <span class="s2">&quot;nb_total&quot;</span><span class="p">])</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-29"><a href="#L-29"><span class="linenos"> 29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">largeur_fenetre</span> <span class="o">=</span> <span class="n">largeur_fenetre</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos"> 30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hauteur_fenetre</span> <span class="o">=</span> <span class="n">hauteur_fenetre</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos"> 31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span> <span class="o">=</span> <span class="n">Grille</span><span class="p">(</span><span class="n">taille_carreau</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">distance_infection</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="o">=</span><span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="o">=</span><span class="n">hauteur_fenetre</span><span class="p">)</span>
</span><span id="L-32"><a href="#L-32"><span class="linenos"> 32</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos"> 33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duree_cooldown_avant_naissance</span> <span class="o">=</span> <span class="n">duree_cooldown_avant_naissance</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos"> 34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">=</span> <span class="n">duree_cooldown_avant_naissance</span>
</span><span id="L-35"><a href="#L-35"><span class="linenos"> 35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">taux_naissance</span> <span class="o">=</span> <span class="n">taux_naissance</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos"> 37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos"> 38</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initialiser_population</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">,</span> <span class="n">pourcentage_infectes</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos"> 39</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos"> 40</span></a><span class="sd">        On crée les personnes de la simulation et on infecte un échantillon.</span>
</span><span id="L-41"><a href="#L-41"><span class="linenos"> 41</span></a><span class="sd">        Par défaut, on met le pourcentage de personnes infectées à 5% mais l&#39;utilisateur peut règler cette valeur.</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos"> 42</span></a><span class="sd">        Il y a également un indicateur du pourcentage que représentent les personnes immunodéprimées parmi la population.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos"> 43</span></a><span class="sd">        On va initialiser chaque personne à une position aléatoire dans la fenêtre.</span>
</span><span id="L-44"><a href="#L-44"><span class="linenos"> 44</span></a><span class="sd">        On utilise randint pour tirer aléatoirement les chances qu&#39;une personne soit immunodéprimée.</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos"> 45</span></a><span class="sd">        Ensuite, on infecte le pourcentage de personnes infectées choisi par la personne.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos"> 46</span></a><span class="sd">        Pour cela, on tire aléatoirement le nombre de personnes qu&#39;il faut.</span>
</span><span id="L-47"><a href="#L-47"><span class="linenos"> 47</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos"> 48</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_personnes</span><span class="p">):</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos"> 49</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">)]</span>
</span><span id="L-50"><a href="#L-50"><span class="linenos"> 50</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pourcentage_immunodeprimes</span><span class="p">:</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos"> 51</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;oui&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos"> 52</span></a>            <span class="k">else</span> <span class="p">:</span>
</span><span id="L-53"><a href="#L-53"><span class="linenos"> 53</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;non&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos"> 54</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos"> 55</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="L-56"><a href="#L-56"><span class="linenos"> 56</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">pourcentage_infectes</span><span class="p">:</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos"> 57</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos"> 58</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="L-59"><a href="#L-59"><span class="linenos"> 59</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_medecin</span><span class="p">()</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos"> 60</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="n">pourcentage_immunodeprimes</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="L-62"><a href="#L-62"><span class="linenos"> 62</span></a>    
</span><span id="L-63"><a href="#L-63"><span class="linenos"> 63</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">propager_infection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos"> 64</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-65"><a href="#L-65"><span class="linenos"> 65</span></a><span class="sd">        On fait la propagation de la maladie aux personnes à côté d&#39;une personne infectée.</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos"> 66</span></a><span class="sd">        Pour chaque personne infectée, on récupère ses voisins, donc ceux dans sa case de la grille ou les 8 cas autour.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos"> 67</span></a><span class="sd">        On regarde si la distance entre les deux points est assez faible pour que la personne puisse être infectée.</span>
</span><span id="L-68"><a href="#L-68"><span class="linenos"> 68</span></a><span class="sd">        Comme la valeur de risque de transmission est un entier entre 1 et 100, on va récupérer une valeur aléatoire.</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos"> 69</span></a><span class="sd">        Si elle est inférieure au pourcentage de risque de transmission, la personne est maintenant infectée.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos"> 70</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-71"><a href="#L-71"><span class="linenos"> 71</span></a>        <span class="n">infectes</span> <span class="o">=</span> <span class="p">[</span><span class="n">personne</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">]</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos"> 72</span></a>        <span class="k">for</span> <span class="n">infecte</span> <span class="ow">in</span> <span class="n">infectes</span><span class="p">:</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos"> 73</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">infecte</span><span class="p">)</span>
</span><span id="L-74"><a href="#L-74"><span class="linenos"> 74</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="p">[</span><span class="n">personne</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="n">voisins</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;sain&quot;</span><span class="p">]</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos"> 75</span></a>            <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span> <span class="p">:</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos"> 76</span></a>                <span class="k">if</span> <span class="n">voisin</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="L-77"><a href="#L-77"><span class="linenos"> 77</span></a>                    <span class="k">if</span> <span class="n">infecte</span><span class="o">.</span><span class="n">etre_en_contact</span><span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">distance_infection</span><span class="p">):</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos"> 78</span></a>                        <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">risque_transmission</span><span class="p">:</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos"> 79</span></a>                            <span class="n">voisin</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span><span id="L-80"><a href="#L-80"><span class="linenos"> 80</span></a>    
</span><span id="L-81"><a href="#L-81"><span class="linenos"> 81</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacements_aleatoires</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos"> 82</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-83"><a href="#L-83"><span class="linenos"> 83</span></a><span class="sd">        On fait se déplacer chaque personne de manière totalement aléatoire, pour ça on ajoute une petite variation en x et en y, dans un intervalle défini.</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos"> 84</span></a><span class="sd">        On vérifie ensuite que la nouvelle position reste dans les limites de la fenêtre : si la personne dépasse le bord, on la replace exactement sur la limite.</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos"> 85</span></a><span class="sd">        Finalement, on met à jour la position et on reconstruit la grille pour la prochaine itération.</span>
</span><span id="L-86"><a href="#L-86"><span class="linenos"> 86</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos"> 87</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos"> 88</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="L-89"><a href="#L-89"><span class="linenos"> 89</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos"> 90</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos"> 91</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="L-92"><a href="#L-92"><span class="linenos"> 92</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos"> 93</span></a>            <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span> <span class="p">:</span>
</span><span id="L-94"><a href="#L-94"><span class="linenos"> 94</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos"> 95</span></a>            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos"> 96</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos"> 97</span></a>            <span class="k">elif</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span> <span class="p">:</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos"> 98</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos"> 99</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos">100</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos">101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos">102</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacements_grille</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos">103</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos">104</span></a><span class="sd">        Chaque personne choisit un carreau voisin au hasard et se déplace si ce carreau est disponible</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos">105</span></a><span class="sd">        À l&#39;intérieur du carreau, la position est légèrement aléatoire pour éviter que tout le monde soit exactement au centre.</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos">106</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos">107</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-108"><a href="#L-108"><span class="linenos">108</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="L-109"><a href="#L-109"><span class="linenos">109</span></a>            <span class="n">carreau_x</span><span class="p">,</span> <span class="n">carreau_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">coordonnees_carreau</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos">110</span></a>            <span class="n">direction_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos">111</span></a>            <span class="n">direction_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos">112</span></a>            <span class="n">nouveau_carreau_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">carreau_x</span> <span class="o">+</span> <span class="n">direction_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">nb_colonnes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos">113</span></a>            <span class="n">nouveau_carreau_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">carreau_y</span> <span class="o">+</span> <span class="n">direction_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">nb_lignes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos">114</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">carreaux</span><span class="p">[</span><span class="n">nouveau_carreau_x</span><span class="p">][</span><span class="n">nouveau_carreau_y</span><span class="p">]:</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos">115</span></a>                <span class="n">deplacement_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos">116</span></a>                <span class="n">deplacement_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos">117</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos">118</span></a>                <span class="n">deplacement_x</span><span class="p">,</span> <span class="n">deplacement_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="L-119"><a href="#L-119"><span class="linenos">119</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nouveau_carreau_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span> <span class="o">+</span> <span class="n">deplacement_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos">120</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nouveau_carreau_y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span> <span class="o">+</span> <span class="n">deplacement_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos">121</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos">122</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="L-123"><a href="#L-123"><span class="linenos">123</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos">124</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos">125</span></a>    
</span><span id="L-126"><a href="#L-126"><span class="linenos">126</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacement_stochastique_directionnel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos">127</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos">128</span></a><span class="sd">        Chaque personne garde une direction générale qui change un peu entre chaque itération avec du hasard</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos">129</span></a><span class="sd">        S&#39;il y a des clusters fort proche de la personne, on limite l&#39;attractivité de la direction, pour éviter des regroupements trop massifs.</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos">130</span></a><span class="sd">        Cela permet d&#39;avoir de la cohésion mais garder quand même des directions qui sont influencées par les voisins sans centrer tout le monde en un point.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos">131</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos">132</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos">133</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="L-134"><a href="#L-134"><span class="linenos">134</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">personne</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">):</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos">135</span></a>                <span class="n">angle</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos">136</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos">137</span></a>            <span class="n">densite</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">))</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos">138</span></a>            <span class="n">exploration</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)]</span>
</span><span id="L-139"><a href="#L-139"><span class="linenos">139</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">densite</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos">140</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">densite</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos">141</span></a>            <span class="n">norme</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos">142</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos">143</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="L-144"><a href="#L-144"><span class="linenos">144</span></a>            <span class="n">pas</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos">145</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos">146</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos">147</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos">148</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos">149</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos">150</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos">151</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos">152</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos">153</span></a> 
</span><span id="L-154"><a href="#L-154"><span class="linenos">154</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacement_boids_simplifie</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos">155</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="L-156"><a href="#L-156"><span class="linenos">156</span></a><span class="sd">        Cette méthode met à jour la direction des personnes en utilisant deux des trois principes de Boids.</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos">157</span></a><span class="sd">        D&#39;abord, on calcule un point moyen des voisins proches pour ajuster légèrement la direction vers ce point.</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos">158</span></a><span class="sd">        Ensuite, on ajoute une force de répulsion si des voisins sont trop proches pour éviter qu&#39;ils se stackent.</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos">159</span></a><span class="sd">        On ajoute aussi une petite valeur aléatoire pour modifier légèrement la direction à chaque étape.</span>
</span><span id="L-160"><a href="#L-160"><span class="linenos">160</span></a><span class="sd">        Enfin, on applique un poids aux murs pour qu&#39;ils qui poussent les personnes vers l&#39;intérieur lorsqu&#39;elles s&#39;approchent trop pour éviter les regroupement contre les murs.</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos">161</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos">162</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos">163</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="p">:</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos">164</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">personne</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">):</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos">165</span></a>                <span class="n">angle</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos">166</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos">167</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos">168</span></a>            <span class="n">centre_voisins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos">169</span></a>            <span class="n">repulsion</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos">170</span></a>            <span class="n">compteur_centre</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos">171</span></a>            <span class="n">compteur_repulsion</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos">172</span></a>            <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span><span class="p">:</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos">173</span></a>                <span class="k">if</span> <span class="n">voisin</span> <span class="ow">is</span> <span class="n">personne</span> <span class="ow">or</span> <span class="n">voisin</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="L-174"><a href="#L-174"><span class="linenos">174</span></a>                    <span class="k">continue</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos">175</span></a>                <span class="n">direction_x</span> <span class="o">=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos">176</span></a>                <span class="n">direction_y</span> <span class="o">=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos">177</span></a>                <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">direction_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">direction_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos">178</span></a>                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos">179</span></a>                    <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos">180</span></a>                    <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos">181</span></a>                    <span class="n">compteur_centre</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos">182</span></a>                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos">183</span></a>                    <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos">184</span></a>                    <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="L-185"><a href="#L-185"><span class="linenos">185</span></a>                    <span class="n">compteur_repulsion</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-186"><a href="#L-186"><span class="linenos">186</span></a>            <span class="k">if</span> <span class="n">compteur_centre</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos">187</span></a>                <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_centre</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos">188</span></a>                <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_centre</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos">189</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.0015</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos">190</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.0015</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos">191</span></a>            <span class="k">if</span> <span class="n">compteur_repulsion</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos">192</span></a>                <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_repulsion</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos">193</span></a>                <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_repulsion</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos">194</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.05</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos">195</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.05</span>
</span><span id="L-196"><a href="#L-196"><span class="linenos">196</span></a>            <span class="n">exploration</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)]</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos">197</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos">198</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos">199</span></a>            <span class="n">marge</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="L-200"><a href="#L-200"><span class="linenos">200</span></a>            <span class="n">force_mur</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos">201</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos">202</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">force_mur</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos">203</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span> <span class="o">-</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos">204</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">force_mur</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos">205</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos">206</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">force_mur</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos">207</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span> <span class="o">-</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos">208</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">force_mur</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos">209</span></a>            <span class="n">norme</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos">210</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos">211</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos">212</span></a>            <span class="n">pas</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="L-213"><a href="#L-213"><span class="linenos">213</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos">214</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos">215</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos">216</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos">217</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="L-218"><a href="#L-218"><span class="linenos">218</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos">219</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos">220</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos">221</span></a>    
</span><span id="L-222"><a href="#L-222"><span class="linenos">222</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">naissance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_nouvelles_personnes</span><span class="p">):</span>
</span><span id="L-223"><a href="#L-223"><span class="linenos">223</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos">224</span></a><span class="sd">        Cette méthode permet d&#39;ajouter de nouvelles personnes à la simulation.</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos">225</span></a><span class="sd">        Le nombre de personnes à créer est donné en paramètre. </span>
</span><span id="L-226"><a href="#L-226"><span class="linenos">226</span></a><span class="sd">        Une fois les personnes ajoutées, la grille est reconstruite pour mettre à jour la répartition des personnes.</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos">227</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos">228</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_nouvelles_personnes</span><span class="p">):</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos">229</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">largeur_fenetre</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hauteur_fenetre</span><span class="p">)]</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos">230</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span><span class="p">:</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos">231</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;oui&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos">232</span></a>            <span class="k">else</span> <span class="p">:</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos">233</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;non&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos">234</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos">235</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_medecin</span><span class="p">()</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos">236</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="L-237"><a href="#L-237"><span class="linenos">237</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos">238</span></a>    
</span><span id="L-239"><a href="#L-239"><span class="linenos">239</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mise_a_jour_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos">240</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos">241</span></a><span class="sd">        On met à jour après chaque itération.</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos">242</span></a><span class="sd">        La mise à jour de la position des personnes suit l&#39;approche de Boids simplifié..</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos">243</span></a><span class="sd">        Ensuite, on reconstruit la grille avec les nouvelles positions, on propage l&#39;infection et on met à jour les états pour chaque personne.</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos">244</span></a><span class="sd">        Pour les calculs, on va estimer que les personnes immunodéprimées ont deux fois plus de chances de mourir.</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos">245</span></a><span class="sd">        Si la personne n&#39;a pas une maladie permanente et qu&#39;elle a survécu à toutes les itérations nécessaires pour que la maladie passe, la personne est guérie.</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos">246</span></a><span class="sd">        Si on est immunisé après la maladie, la personne gagne ce statut, sinon elle est juste saine à nouveau.</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos">247</span></a><span class="sd">        Finalement, on enregistre les statistiques actuelles sous forme de dataframe en calculant le nombre de personnes par état.</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos">248</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="L-249"><a href="#L-249"><span class="linenos">249</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">deplacement_boids_simplifie</span><span class="p">()</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos">250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">propager_infection</span><span class="p">()</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos">251</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos">252</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos">253</span></a>        <span class="k">else</span> <span class="p">:</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos">254</span></a>            <span class="n">nb_total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos">255</span></a>            <span class="n">nb_naissance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">nb_total</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">taux_naissance</span><span class="p">)</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos">256</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">naissance</span><span class="p">(</span><span class="n">nb_naissance</span><span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos">257</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duree_cooldown_avant_naissance</span>
</span><span id="L-258"><a href="#L-258"><span class="linenos">258</span></a>
</span><span id="L-259"><a href="#L-259"><span class="linenos">259</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="L-260"><a href="#L-260"><span class="linenos">260</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">:</span>
</span><span id="L-261"><a href="#L-261"><span class="linenos">261</span></a>                <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos">262</span></a>                <span class="n">medecin_autour</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos">263</span></a>                <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span><span class="p">:</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos">264</span></a>                    <span class="k">if</span> <span class="n">voisin</span><span class="o">.</span><span class="n">medecin</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">voisin</span><span class="o">.</span><span class="n">etat</span> <span class="o">!=</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos">265</span></a>                        <span class="n">medecin_autour</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos">266</span></a>
</span><span id="L-267"><a href="#L-267"><span class="linenos">267</span></a>                <span class="n">risque_mort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">taux_letalite</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">)</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos">268</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">immunodeprime</span> <span class="o">==</span> <span class="s2">&quot;oui&quot;</span><span class="p">:</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos">269</span></a>                    <span class="n">risque_mort</span> <span class="o">*=</span> <span class="mf">1.2</span>
</span><span id="L-270"><a href="#L-270"><span class="linenos">270</span></a>                <span class="k">if</span> <span class="n">medecin_autour</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos">271</span></a>                    <span class="n">risque_mort</span> <span class="o">/=</span> <span class="mi">2</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos">272</span></a>                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">risque_mort</span><span class="p">:</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos">273</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">mourir</span><span class="p">()</span>
</span><span id="L-274"><a href="#L-274"><span class="linenos">274</span></a>                    <span class="k">continue</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos">275</span></a>
</span><span id="L-276"><a href="#L-276"><span class="linenos">276</span></a>                <span class="k">if</span> <span class="n">medecin_autour</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos">277</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos">278</span></a>                <span class="k">else</span> <span class="p">:</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos">279</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos">280</span></a>
</span><span id="L-281"><a href="#L-281"><span class="linenos">281</span></a>                <span class="n">aleatoire</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos">282</span></a>                <span class="k">if</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos">283</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos">284</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="L-285"><a href="#L-285"><span class="linenos">285</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos">286</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">:</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos">287</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos">288</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">:</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos">289</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">-=</span> <span class="mi">2</span>
</span><span id="L-290"><a href="#L-290"><span class="linenos">290</span></a>
</span><span id="L-291"><a href="#L-291"><span class="linenos">291</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">:</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos">292</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">immunite_apres_guerison</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos">293</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">etre_immunise</span><span class="p">()</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos">294</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="L-295"><a href="#L-295"><span class="linenos">295</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">guerir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">)</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos">296</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos">297</span></a>                    <span class="k">continue</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos">298</span></a>            <span class="k">elif</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s1">&#39;sain&#39;</span> <span class="p">:</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos">299</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos">300</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos">301</span></a>            <span class="k">elif</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s1">&#39;mort&#39;</span><span class="p">:</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos">302</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_affichage_apres_mort</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos">303</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_affichage_apres_mort</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos">304</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="p">:</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos">305</span></a>            <span class="n">quantite_infectes_relance</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos">306</span></a>            <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos">307</span></a>                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">quantite_infectes_relance</span> <span class="ow">and</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">!=</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos">308</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos">309</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos">310</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="o">*</span><span class="mf">0.75</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos">311</span></a>        <span class="n">nb_morts</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;mort&quot;</span><span class="p">)</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos">312</span></a>        <span class="n">nb_infectes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">)</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos">313</span></a>        <span class="n">nb_total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos">314</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_morts</span><span class="p">,</span> <span class="n">nb_total</span><span class="p">]</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos">315</span></a>        <span class="k">if</span> <span class="n">nb_infectes</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos">316</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos">317</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
</span></pre></div>


            </section>
                <section id="Simulation">
                            <input id="Simulation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr class">
            
    <span class="def">class</span>
    <span class="name">Simulation</span>:

                <label class="view-source-button" for="Simulation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation-10"><a href="#Simulation-10"><span class="linenos"> 10</span></a><span class="k">class</span><span class="w"> </span><span class="nc">Simulation</span> <span class="p">:</span>
</span><span id="Simulation-11"><a href="#Simulation-11"><span class="linenos"> 11</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-12"><a href="#Simulation-12"><span class="linenos"> 12</span></a><span class="sd">    On implémente ensuite la classe simulation, qui permet de construire toute la structure pour la simulation.</span>
</span><span id="Simulation-13"><a href="#Simulation-13"><span class="linenos"> 13</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="Simulation-14"><a href="#Simulation-14"><span class="linenos"> 14</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maladie</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">,</span> <span class="n">duree_cooldown_avant_naissance</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">nb_personnes</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">taux_naissance</span><span class="o">=</span><span class="mf">0.02</span><span class="p">):</span>
</span><span id="Simulation-15"><a href="#Simulation-15"><span class="linenos"> 15</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-16"><a href="#Simulation-16"><span class="linenos"> 16</span></a><span class="sd">        Nb personnes est le nombre de personnes totales dans la simulation, tout état confondu.</span>
</span><span id="Simulation-17"><a href="#Simulation-17"><span class="linenos"> 17</span></a><span class="sd">        Maladie est l&#39;objet de classe Maladie que la simulation va répandre.</span>
</span><span id="Simulation-18"><a href="#Simulation-18"><span class="linenos"> 18</span></a><span class="sd">        Liste personnes permet de stocker les personnes de la simulation.</span>
</span><span id="Simulation-19"><a href="#Simulation-19"><span class="linenos"> 19</span></a><span class="sd">        On stocke les statistiques qui peuvent servir pour la réalisation des statistiques dans l&#39;attribut df_historique.</span>
</span><span id="Simulation-20"><a href="#Simulation-20"><span class="linenos"> 20</span></a><span class="sd">        On fait le stockage directement dans un dataframe pour que ce soit plus simple pour la réalisation des schémas matplotlib; car c&#39;est la structure priviligiée pour ça.</span>
</span><span id="Simulation-21"><a href="#Simulation-21"><span class="linenos"> 21</span></a><span class="sd">        Iteration est le numéro de l&#39;itération en cours.</span>
</span><span id="Simulation-22"><a href="#Simulation-22"><span class="linenos"> 22</span></a><span class="sd">        Grille est l&#39;objet de classe Grille associé à la simulation.</span>
</span><span id="Simulation-23"><a href="#Simulation-23"><span class="linenos"> 23</span></a><span class="sd">        Taux naissance représente le pourcentage d&#39;enfants nés dans la population.</span>
</span><span id="Simulation-24"><a href="#Simulation-24"><span class="linenos"> 24</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-25"><a href="#Simulation-25"><span class="linenos"> 25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nb_personnes</span> <span class="o">=</span> <span class="n">nb_personnes</span>
</span><span id="Simulation-26"><a href="#Simulation-26"><span class="linenos"> 26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span> <span class="o">=</span> <span class="n">maladie</span>
</span><span id="Simulation-27"><a href="#Simulation-27"><span class="linenos"> 27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Simulation-28"><a href="#Simulation-28"><span class="linenos"> 28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nb_morts&quot;</span><span class="p">,</span> <span class="s2">&quot;nb_total&quot;</span><span class="p">])</span>
</span><span id="Simulation-29"><a href="#Simulation-29"><span class="linenos"> 29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-30"><a href="#Simulation-30"><span class="linenos"> 30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">largeur_fenetre</span> <span class="o">=</span> <span class="n">largeur_fenetre</span>
</span><span id="Simulation-31"><a href="#Simulation-31"><span class="linenos"> 31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hauteur_fenetre</span> <span class="o">=</span> <span class="n">hauteur_fenetre</span>
</span><span id="Simulation-32"><a href="#Simulation-32"><span class="linenos"> 32</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span> <span class="o">=</span> <span class="n">Grille</span><span class="p">(</span><span class="n">taille_carreau</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">distance_infection</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="o">=</span><span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="o">=</span><span class="n">hauteur_fenetre</span><span class="p">)</span>
</span><span id="Simulation-33"><a href="#Simulation-33"><span class="linenos"> 33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-34"><a href="#Simulation-34"><span class="linenos"> 34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duree_cooldown_avant_naissance</span> <span class="o">=</span> <span class="n">duree_cooldown_avant_naissance</span>
</span><span id="Simulation-35"><a href="#Simulation-35"><span class="linenos"> 35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">=</span> <span class="n">duree_cooldown_avant_naissance</span>
</span><span id="Simulation-36"><a href="#Simulation-36"><span class="linenos"> 36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-37"><a href="#Simulation-37"><span class="linenos"> 37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">taux_naissance</span> <span class="o">=</span> <span class="n">taux_naissance</span>
</span><span id="Simulation-38"><a href="#Simulation-38"><span class="linenos"> 38</span></a>
</span><span id="Simulation-39"><a href="#Simulation-39"><span class="linenos"> 39</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initialiser_population</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">,</span> <span class="n">pourcentage_infectes</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
</span><span id="Simulation-40"><a href="#Simulation-40"><span class="linenos"> 40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-41"><a href="#Simulation-41"><span class="linenos"> 41</span></a><span class="sd">        On crée les personnes de la simulation et on infecte un échantillon.</span>
</span><span id="Simulation-42"><a href="#Simulation-42"><span class="linenos"> 42</span></a><span class="sd">        Par défaut, on met le pourcentage de personnes infectées à 5% mais l&#39;utilisateur peut règler cette valeur.</span>
</span><span id="Simulation-43"><a href="#Simulation-43"><span class="linenos"> 43</span></a><span class="sd">        Il y a également un indicateur du pourcentage que représentent les personnes immunodéprimées parmi la population.</span>
</span><span id="Simulation-44"><a href="#Simulation-44"><span class="linenos"> 44</span></a><span class="sd">        On va initialiser chaque personne à une position aléatoire dans la fenêtre.</span>
</span><span id="Simulation-45"><a href="#Simulation-45"><span class="linenos"> 45</span></a><span class="sd">        On utilise randint pour tirer aléatoirement les chances qu&#39;une personne soit immunodéprimée.</span>
</span><span id="Simulation-46"><a href="#Simulation-46"><span class="linenos"> 46</span></a><span class="sd">        Ensuite, on infecte le pourcentage de personnes infectées choisi par la personne.</span>
</span><span id="Simulation-47"><a href="#Simulation-47"><span class="linenos"> 47</span></a><span class="sd">        Pour cela, on tire aléatoirement le nombre de personnes qu&#39;il faut.</span>
</span><span id="Simulation-48"><a href="#Simulation-48"><span class="linenos"> 48</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-49"><a href="#Simulation-49"><span class="linenos"> 49</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_personnes</span><span class="p">):</span>
</span><span id="Simulation-50"><a href="#Simulation-50"><span class="linenos"> 50</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">)]</span>
</span><span id="Simulation-51"><a href="#Simulation-51"><span class="linenos"> 51</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pourcentage_immunodeprimes</span><span class="p">:</span>
</span><span id="Simulation-52"><a href="#Simulation-52"><span class="linenos"> 52</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;oui&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="Simulation-53"><a href="#Simulation-53"><span class="linenos"> 53</span></a>            <span class="k">else</span> <span class="p">:</span>
</span><span id="Simulation-54"><a href="#Simulation-54"><span class="linenos"> 54</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;non&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="Simulation-55"><a href="#Simulation-55"><span class="linenos"> 55</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="Simulation-56"><a href="#Simulation-56"><span class="linenos"> 56</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation-57"><a href="#Simulation-57"><span class="linenos"> 57</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">pourcentage_infectes</span><span class="p">:</span>
</span><span id="Simulation-58"><a href="#Simulation-58"><span class="linenos"> 58</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span><span id="Simulation-59"><a href="#Simulation-59"><span class="linenos"> 59</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Simulation-60"><a href="#Simulation-60"><span class="linenos"> 60</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_medecin</span><span class="p">()</span>
</span><span id="Simulation-61"><a href="#Simulation-61"><span class="linenos"> 61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="n">pourcentage_immunodeprimes</span>
</span><span id="Simulation-62"><a href="#Simulation-62"><span class="linenos"> 62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="Simulation-63"><a href="#Simulation-63"><span class="linenos"> 63</span></a>    
</span><span id="Simulation-64"><a href="#Simulation-64"><span class="linenos"> 64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">propager_infection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation-65"><a href="#Simulation-65"><span class="linenos"> 65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-66"><a href="#Simulation-66"><span class="linenos"> 66</span></a><span class="sd">        On fait la propagation de la maladie aux personnes à côté d&#39;une personne infectée.</span>
</span><span id="Simulation-67"><a href="#Simulation-67"><span class="linenos"> 67</span></a><span class="sd">        Pour chaque personne infectée, on récupère ses voisins, donc ceux dans sa case de la grille ou les 8 cas autour.</span>
</span><span id="Simulation-68"><a href="#Simulation-68"><span class="linenos"> 68</span></a><span class="sd">        On regarde si la distance entre les deux points est assez faible pour que la personne puisse être infectée.</span>
</span><span id="Simulation-69"><a href="#Simulation-69"><span class="linenos"> 69</span></a><span class="sd">        Comme la valeur de risque de transmission est un entier entre 1 et 100, on va récupérer une valeur aléatoire.</span>
</span><span id="Simulation-70"><a href="#Simulation-70"><span class="linenos"> 70</span></a><span class="sd">        Si elle est inférieure au pourcentage de risque de transmission, la personne est maintenant infectée.</span>
</span><span id="Simulation-71"><a href="#Simulation-71"><span class="linenos"> 71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-72"><a href="#Simulation-72"><span class="linenos"> 72</span></a>        <span class="n">infectes</span> <span class="o">=</span> <span class="p">[</span><span class="n">personne</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">]</span>
</span><span id="Simulation-73"><a href="#Simulation-73"><span class="linenos"> 73</span></a>        <span class="k">for</span> <span class="n">infecte</span> <span class="ow">in</span> <span class="n">infectes</span><span class="p">:</span>
</span><span id="Simulation-74"><a href="#Simulation-74"><span class="linenos"> 74</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">infecte</span><span class="p">)</span>
</span><span id="Simulation-75"><a href="#Simulation-75"><span class="linenos"> 75</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="p">[</span><span class="n">personne</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="n">voisins</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;sain&quot;</span><span class="p">]</span>
</span><span id="Simulation-76"><a href="#Simulation-76"><span class="linenos"> 76</span></a>            <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span> <span class="p">:</span>
</span><span id="Simulation-77"><a href="#Simulation-77"><span class="linenos"> 77</span></a>                <span class="k">if</span> <span class="n">voisin</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation-78"><a href="#Simulation-78"><span class="linenos"> 78</span></a>                    <span class="k">if</span> <span class="n">infecte</span><span class="o">.</span><span class="n">etre_en_contact</span><span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">distance_infection</span><span class="p">):</span>
</span><span id="Simulation-79"><a href="#Simulation-79"><span class="linenos"> 79</span></a>                        <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">risque_transmission</span><span class="p">:</span>
</span><span id="Simulation-80"><a href="#Simulation-80"><span class="linenos"> 80</span></a>                            <span class="n">voisin</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span><span id="Simulation-81"><a href="#Simulation-81"><span class="linenos"> 81</span></a>    
</span><span id="Simulation-82"><a href="#Simulation-82"><span class="linenos"> 82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacements_aleatoires</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation-83"><a href="#Simulation-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-84"><a href="#Simulation-84"><span class="linenos"> 84</span></a><span class="sd">        On fait se déplacer chaque personne de manière totalement aléatoire, pour ça on ajoute une petite variation en x et en y, dans un intervalle défini.</span>
</span><span id="Simulation-85"><a href="#Simulation-85"><span class="linenos"> 85</span></a><span class="sd">        On vérifie ensuite que la nouvelle position reste dans les limites de la fenêtre : si la personne dépasse le bord, on la replace exactement sur la limite.</span>
</span><span id="Simulation-86"><a href="#Simulation-86"><span class="linenos"> 86</span></a><span class="sd">        Finalement, on met à jour la position et on reconstruit la grille pour la prochaine itération.</span>
</span><span id="Simulation-87"><a href="#Simulation-87"><span class="linenos"> 87</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-88"><a href="#Simulation-88"><span class="linenos"> 88</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>
</span><span id="Simulation-89"><a href="#Simulation-89"><span class="linenos"> 89</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation-90"><a href="#Simulation-90"><span class="linenos"> 90</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="Simulation-91"><a href="#Simulation-91"><span class="linenos"> 91</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="Simulation-92"><a href="#Simulation-92"><span class="linenos"> 92</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation-93"><a href="#Simulation-93"><span class="linenos"> 93</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-94"><a href="#Simulation-94"><span class="linenos"> 94</span></a>            <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span> <span class="p">:</span>
</span><span id="Simulation-95"><a href="#Simulation-95"><span class="linenos"> 95</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span>
</span><span id="Simulation-96"><a href="#Simulation-96"><span class="linenos"> 96</span></a>            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation-97"><a href="#Simulation-97"><span class="linenos"> 97</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-98"><a href="#Simulation-98"><span class="linenos"> 98</span></a>            <span class="k">elif</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span> <span class="p">:</span>
</span><span id="Simulation-99"><a href="#Simulation-99"><span class="linenos"> 99</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span>
</span><span id="Simulation-100"><a href="#Simulation-100"><span class="linenos">100</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="Simulation-101"><a href="#Simulation-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="Simulation-102"><a href="#Simulation-102"><span class="linenos">102</span></a>
</span><span id="Simulation-103"><a href="#Simulation-103"><span class="linenos">103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacements_grille</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation-104"><a href="#Simulation-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-105"><a href="#Simulation-105"><span class="linenos">105</span></a><span class="sd">        Chaque personne choisit un carreau voisin au hasard et se déplace si ce carreau est disponible</span>
</span><span id="Simulation-106"><a href="#Simulation-106"><span class="linenos">106</span></a><span class="sd">        À l&#39;intérieur du carreau, la position est légèrement aléatoire pour éviter que tout le monde soit exactement au centre.</span>
</span><span id="Simulation-107"><a href="#Simulation-107"><span class="linenos">107</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-108"><a href="#Simulation-108"><span class="linenos">108</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Simulation-109"><a href="#Simulation-109"><span class="linenos">109</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation-110"><a href="#Simulation-110"><span class="linenos">110</span></a>            <span class="n">carreau_x</span><span class="p">,</span> <span class="n">carreau_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">coordonnees_carreau</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</span><span id="Simulation-111"><a href="#Simulation-111"><span class="linenos">111</span></a>            <span class="n">direction_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Simulation-112"><a href="#Simulation-112"><span class="linenos">112</span></a>            <span class="n">direction_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Simulation-113"><a href="#Simulation-113"><span class="linenos">113</span></a>            <span class="n">nouveau_carreau_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">carreau_x</span> <span class="o">+</span> <span class="n">direction_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">nb_colonnes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Simulation-114"><a href="#Simulation-114"><span class="linenos">114</span></a>            <span class="n">nouveau_carreau_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">carreau_y</span> <span class="o">+</span> <span class="n">direction_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">nb_lignes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Simulation-115"><a href="#Simulation-115"><span class="linenos">115</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">carreaux</span><span class="p">[</span><span class="n">nouveau_carreau_x</span><span class="p">][</span><span class="n">nouveau_carreau_y</span><span class="p">]:</span>
</span><span id="Simulation-116"><a href="#Simulation-116"><span class="linenos">116</span></a>                <span class="n">deplacement_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation-117"><a href="#Simulation-117"><span class="linenos">117</span></a>                <span class="n">deplacement_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation-118"><a href="#Simulation-118"><span class="linenos">118</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Simulation-119"><a href="#Simulation-119"><span class="linenos">119</span></a>                <span class="n">deplacement_x</span><span class="p">,</span> <span class="n">deplacement_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="Simulation-120"><a href="#Simulation-120"><span class="linenos">120</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nouveau_carreau_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span> <span class="o">+</span> <span class="n">deplacement_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="Simulation-121"><a href="#Simulation-121"><span class="linenos">121</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nouveau_carreau_y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span> <span class="o">+</span> <span class="n">deplacement_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="Simulation-122"><a href="#Simulation-122"><span class="linenos">122</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="Simulation-123"><a href="#Simulation-123"><span class="linenos">123</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="Simulation-124"><a href="#Simulation-124"><span class="linenos">124</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="Simulation-125"><a href="#Simulation-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="Simulation-126"><a href="#Simulation-126"><span class="linenos">126</span></a>    
</span><span id="Simulation-127"><a href="#Simulation-127"><span class="linenos">127</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacement_stochastique_directionnel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation-128"><a href="#Simulation-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-129"><a href="#Simulation-129"><span class="linenos">129</span></a><span class="sd">        Chaque personne garde une direction générale qui change un peu entre chaque itération avec du hasard</span>
</span><span id="Simulation-130"><a href="#Simulation-130"><span class="linenos">130</span></a><span class="sd">        S&#39;il y a des clusters fort proche de la personne, on limite l&#39;attractivité de la direction, pour éviter des regroupements trop massifs.</span>
</span><span id="Simulation-131"><a href="#Simulation-131"><span class="linenos">131</span></a><span class="sd">        Cela permet d&#39;avoir de la cohésion mais garder quand même des directions qui sont influencées par les voisins sans centrer tout le monde en un point.</span>
</span><span id="Simulation-132"><a href="#Simulation-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-133"><a href="#Simulation-133"><span class="linenos">133</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Simulation-134"><a href="#Simulation-134"><span class="linenos">134</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation-135"><a href="#Simulation-135"><span class="linenos">135</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">personne</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">):</span>
</span><span id="Simulation-136"><a href="#Simulation-136"><span class="linenos">136</span></a>                <span class="n">angle</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="Simulation-137"><a href="#Simulation-137"><span class="linenos">137</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]</span>
</span><span id="Simulation-138"><a href="#Simulation-138"><span class="linenos">138</span></a>            <span class="n">densite</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">))</span>
</span><span id="Simulation-139"><a href="#Simulation-139"><span class="linenos">139</span></a>            <span class="n">exploration</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)]</span>
</span><span id="Simulation-140"><a href="#Simulation-140"><span class="linenos">140</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">densite</span>
</span><span id="Simulation-141"><a href="#Simulation-141"><span class="linenos">141</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">densite</span>
</span><span id="Simulation-142"><a href="#Simulation-142"><span class="linenos">142</span></a>            <span class="n">norme</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation-143"><a href="#Simulation-143"><span class="linenos">143</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="Simulation-144"><a href="#Simulation-144"><span class="linenos">144</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="Simulation-145"><a href="#Simulation-145"><span class="linenos">145</span></a>            <span class="n">pas</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="Simulation-146"><a href="#Simulation-146"><span class="linenos">146</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="Simulation-147"><a href="#Simulation-147"><span class="linenos">147</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="Simulation-148"><a href="#Simulation-148"><span class="linenos">148</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="Simulation-149"><a href="#Simulation-149"><span class="linenos">149</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="Simulation-150"><a href="#Simulation-150"><span class="linenos">150</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="Simulation-151"><a href="#Simulation-151"><span class="linenos">151</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="Simulation-152"><a href="#Simulation-152"><span class="linenos">152</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="Simulation-153"><a href="#Simulation-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="Simulation-154"><a href="#Simulation-154"><span class="linenos">154</span></a> 
</span><span id="Simulation-155"><a href="#Simulation-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacement_boids_simplifie</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation-156"><a href="#Simulation-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="Simulation-157"><a href="#Simulation-157"><span class="linenos">157</span></a><span class="sd">        Cette méthode met à jour la direction des personnes en utilisant deux des trois principes de Boids.</span>
</span><span id="Simulation-158"><a href="#Simulation-158"><span class="linenos">158</span></a><span class="sd">        D&#39;abord, on calcule un point moyen des voisins proches pour ajuster légèrement la direction vers ce point.</span>
</span><span id="Simulation-159"><a href="#Simulation-159"><span class="linenos">159</span></a><span class="sd">        Ensuite, on ajoute une force de répulsion si des voisins sont trop proches pour éviter qu&#39;ils se stackent.</span>
</span><span id="Simulation-160"><a href="#Simulation-160"><span class="linenos">160</span></a><span class="sd">        On ajoute aussi une petite valeur aléatoire pour modifier légèrement la direction à chaque étape.</span>
</span><span id="Simulation-161"><a href="#Simulation-161"><span class="linenos">161</span></a><span class="sd">        Enfin, on applique un poids aux murs pour qu&#39;ils qui poussent les personnes vers l&#39;intérieur lorsqu&#39;elles s&#39;approchent trop pour éviter les regroupement contre les murs.</span>
</span><span id="Simulation-162"><a href="#Simulation-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-163"><a href="#Simulation-163"><span class="linenos">163</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Simulation-164"><a href="#Simulation-164"><span class="linenos">164</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="p">:</span>
</span><span id="Simulation-165"><a href="#Simulation-165"><span class="linenos">165</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">personne</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">):</span>
</span><span id="Simulation-166"><a href="#Simulation-166"><span class="linenos">166</span></a>                <span class="n">angle</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="Simulation-167"><a href="#Simulation-167"><span class="linenos">167</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]</span>
</span><span id="Simulation-168"><a href="#Simulation-168"><span class="linenos">168</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="Simulation-169"><a href="#Simulation-169"><span class="linenos">169</span></a>            <span class="n">centre_voisins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation-170"><a href="#Simulation-170"><span class="linenos">170</span></a>            <span class="n">repulsion</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation-171"><a href="#Simulation-171"><span class="linenos">171</span></a>            <span class="n">compteur_centre</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-172"><a href="#Simulation-172"><span class="linenos">172</span></a>            <span class="n">compteur_repulsion</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-173"><a href="#Simulation-173"><span class="linenos">173</span></a>            <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span><span class="p">:</span>
</span><span id="Simulation-174"><a href="#Simulation-174"><span class="linenos">174</span></a>                <span class="k">if</span> <span class="n">voisin</span> <span class="ow">is</span> <span class="n">personne</span> <span class="ow">or</span> <span class="n">voisin</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="Simulation-175"><a href="#Simulation-175"><span class="linenos">175</span></a>                    <span class="k">continue</span>
</span><span id="Simulation-176"><a href="#Simulation-176"><span class="linenos">176</span></a>                <span class="n">direction_x</span> <span class="o">=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation-177"><a href="#Simulation-177"><span class="linenos">177</span></a>                <span class="n">direction_y</span> <span class="o">=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Simulation-178"><a href="#Simulation-178"><span class="linenos">178</span></a>                <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">direction_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">direction_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation-179"><a href="#Simulation-179"><span class="linenos">179</span></a>                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="Simulation-180"><a href="#Simulation-180"><span class="linenos">180</span></a>                    <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation-181"><a href="#Simulation-181"><span class="linenos">181</span></a>                    <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Simulation-182"><a href="#Simulation-182"><span class="linenos">182</span></a>                    <span class="n">compteur_centre</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation-183"><a href="#Simulation-183"><span class="linenos">183</span></a>                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="Simulation-184"><a href="#Simulation-184"><span class="linenos">184</span></a>                    <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Simulation-185"><a href="#Simulation-185"><span class="linenos">185</span></a>                    <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Simulation-186"><a href="#Simulation-186"><span class="linenos">186</span></a>                    <span class="n">compteur_repulsion</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation-187"><a href="#Simulation-187"><span class="linenos">187</span></a>            <span class="k">if</span> <span class="n">compteur_centre</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Simulation-188"><a href="#Simulation-188"><span class="linenos">188</span></a>                <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_centre</span>
</span><span id="Simulation-189"><a href="#Simulation-189"><span class="linenos">189</span></a>                <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_centre</span>
</span><span id="Simulation-190"><a href="#Simulation-190"><span class="linenos">190</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.0015</span>
</span><span id="Simulation-191"><a href="#Simulation-191"><span class="linenos">191</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.0015</span>
</span><span id="Simulation-192"><a href="#Simulation-192"><span class="linenos">192</span></a>            <span class="k">if</span> <span class="n">compteur_repulsion</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Simulation-193"><a href="#Simulation-193"><span class="linenos">193</span></a>                <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_repulsion</span>
</span><span id="Simulation-194"><a href="#Simulation-194"><span class="linenos">194</span></a>                <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_repulsion</span>
</span><span id="Simulation-195"><a href="#Simulation-195"><span class="linenos">195</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.05</span>
</span><span id="Simulation-196"><a href="#Simulation-196"><span class="linenos">196</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.05</span>
</span><span id="Simulation-197"><a href="#Simulation-197"><span class="linenos">197</span></a>            <span class="n">exploration</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)]</span>
</span><span id="Simulation-198"><a href="#Simulation-198"><span class="linenos">198</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation-199"><a href="#Simulation-199"><span class="linenos">199</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Simulation-200"><a href="#Simulation-200"><span class="linenos">200</span></a>            <span class="n">marge</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="Simulation-201"><a href="#Simulation-201"><span class="linenos">201</span></a>            <span class="n">force_mur</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Simulation-202"><a href="#Simulation-202"><span class="linenos">202</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="Simulation-203"><a href="#Simulation-203"><span class="linenos">203</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">force_mur</span>
</span><span id="Simulation-204"><a href="#Simulation-204"><span class="linenos">204</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span> <span class="o">-</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="Simulation-205"><a href="#Simulation-205"><span class="linenos">205</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">force_mur</span>
</span><span id="Simulation-206"><a href="#Simulation-206"><span class="linenos">206</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="Simulation-207"><a href="#Simulation-207"><span class="linenos">207</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">force_mur</span>
</span><span id="Simulation-208"><a href="#Simulation-208"><span class="linenos">208</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span> <span class="o">-</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="Simulation-209"><a href="#Simulation-209"><span class="linenos">209</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">force_mur</span>
</span><span id="Simulation-210"><a href="#Simulation-210"><span class="linenos">210</span></a>            <span class="n">norme</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation-211"><a href="#Simulation-211"><span class="linenos">211</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="Simulation-212"><a href="#Simulation-212"><span class="linenos">212</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="Simulation-213"><a href="#Simulation-213"><span class="linenos">213</span></a>            <span class="n">pas</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Simulation-214"><a href="#Simulation-214"><span class="linenos">214</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="Simulation-215"><a href="#Simulation-215"><span class="linenos">215</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="Simulation-216"><a href="#Simulation-216"><span class="linenos">216</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="Simulation-217"><a href="#Simulation-217"><span class="linenos">217</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="Simulation-218"><a href="#Simulation-218"><span class="linenos">218</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="Simulation-219"><a href="#Simulation-219"><span class="linenos">219</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="Simulation-220"><a href="#Simulation-220"><span class="linenos">220</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="Simulation-221"><a href="#Simulation-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="Simulation-222"><a href="#Simulation-222"><span class="linenos">222</span></a>    
</span><span id="Simulation-223"><a href="#Simulation-223"><span class="linenos">223</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">naissance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_nouvelles_personnes</span><span class="p">):</span>
</span><span id="Simulation-224"><a href="#Simulation-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-225"><a href="#Simulation-225"><span class="linenos">225</span></a><span class="sd">        Cette méthode permet d&#39;ajouter de nouvelles personnes à la simulation.</span>
</span><span id="Simulation-226"><a href="#Simulation-226"><span class="linenos">226</span></a><span class="sd">        Le nombre de personnes à créer est donné en paramètre. </span>
</span><span id="Simulation-227"><a href="#Simulation-227"><span class="linenos">227</span></a><span class="sd">        Une fois les personnes ajoutées, la grille est reconstruite pour mettre à jour la répartition des personnes.</span>
</span><span id="Simulation-228"><a href="#Simulation-228"><span class="linenos">228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-229"><a href="#Simulation-229"><span class="linenos">229</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_nouvelles_personnes</span><span class="p">):</span>
</span><span id="Simulation-230"><a href="#Simulation-230"><span class="linenos">230</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">largeur_fenetre</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hauteur_fenetre</span><span class="p">)]</span>
</span><span id="Simulation-231"><a href="#Simulation-231"><span class="linenos">231</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span><span class="p">:</span>
</span><span id="Simulation-232"><a href="#Simulation-232"><span class="linenos">232</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;oui&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="Simulation-233"><a href="#Simulation-233"><span class="linenos">233</span></a>            <span class="k">else</span> <span class="p">:</span>
</span><span id="Simulation-234"><a href="#Simulation-234"><span class="linenos">234</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;non&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="Simulation-235"><a href="#Simulation-235"><span class="linenos">235</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Simulation-236"><a href="#Simulation-236"><span class="linenos">236</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_medecin</span><span class="p">()</span>
</span><span id="Simulation-237"><a href="#Simulation-237"><span class="linenos">237</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="Simulation-238"><a href="#Simulation-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="Simulation-239"><a href="#Simulation-239"><span class="linenos">239</span></a>    
</span><span id="Simulation-240"><a href="#Simulation-240"><span class="linenos">240</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mise_a_jour_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation-241"><a href="#Simulation-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation-242"><a href="#Simulation-242"><span class="linenos">242</span></a><span class="sd">        On met à jour après chaque itération.</span>
</span><span id="Simulation-243"><a href="#Simulation-243"><span class="linenos">243</span></a><span class="sd">        La mise à jour de la position des personnes suit l&#39;approche de Boids simplifié..</span>
</span><span id="Simulation-244"><a href="#Simulation-244"><span class="linenos">244</span></a><span class="sd">        Ensuite, on reconstruit la grille avec les nouvelles positions, on propage l&#39;infection et on met à jour les états pour chaque personne.</span>
</span><span id="Simulation-245"><a href="#Simulation-245"><span class="linenos">245</span></a><span class="sd">        Pour les calculs, on va estimer que les personnes immunodéprimées ont deux fois plus de chances de mourir.</span>
</span><span id="Simulation-246"><a href="#Simulation-246"><span class="linenos">246</span></a><span class="sd">        Si la personne n&#39;a pas une maladie permanente et qu&#39;elle a survécu à toutes les itérations nécessaires pour que la maladie passe, la personne est guérie.</span>
</span><span id="Simulation-247"><a href="#Simulation-247"><span class="linenos">247</span></a><span class="sd">        Si on est immunisé après la maladie, la personne gagne ce statut, sinon elle est juste saine à nouveau.</span>
</span><span id="Simulation-248"><a href="#Simulation-248"><span class="linenos">248</span></a><span class="sd">        Finalement, on enregistre les statistiques actuelles sous forme de dataframe en calculant le nombre de personnes par état.</span>
</span><span id="Simulation-249"><a href="#Simulation-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation-250"><a href="#Simulation-250"><span class="linenos">250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">deplacement_boids_simplifie</span><span class="p">()</span>
</span><span id="Simulation-251"><a href="#Simulation-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">propager_infection</span><span class="p">()</span>
</span><span id="Simulation-252"><a href="#Simulation-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation-253"><a href="#Simulation-253"><span class="linenos">253</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Simulation-254"><a href="#Simulation-254"><span class="linenos">254</span></a>        <span class="k">else</span> <span class="p">:</span>
</span><span id="Simulation-255"><a href="#Simulation-255"><span class="linenos">255</span></a>            <span class="n">nb_total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation-256"><a href="#Simulation-256"><span class="linenos">256</span></a>            <span class="n">nb_naissance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">nb_total</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">taux_naissance</span><span class="p">)</span>
</span><span id="Simulation-257"><a href="#Simulation-257"><span class="linenos">257</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">naissance</span><span class="p">(</span><span class="n">nb_naissance</span><span class="p">)</span>
</span><span id="Simulation-258"><a href="#Simulation-258"><span class="linenos">258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duree_cooldown_avant_naissance</span>
</span><span id="Simulation-259"><a href="#Simulation-259"><span class="linenos">259</span></a>
</span><span id="Simulation-260"><a href="#Simulation-260"><span class="linenos">260</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation-261"><a href="#Simulation-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">:</span>
</span><span id="Simulation-262"><a href="#Simulation-262"><span class="linenos">262</span></a>                <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="Simulation-263"><a href="#Simulation-263"><span class="linenos">263</span></a>                <span class="n">medecin_autour</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-264"><a href="#Simulation-264"><span class="linenos">264</span></a>                <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span><span class="p">:</span>
</span><span id="Simulation-265"><a href="#Simulation-265"><span class="linenos">265</span></a>                    <span class="k">if</span> <span class="n">voisin</span><span class="o">.</span><span class="n">medecin</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">voisin</span><span class="o">.</span><span class="n">etat</span> <span class="o">!=</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="Simulation-266"><a href="#Simulation-266"><span class="linenos">266</span></a>                        <span class="n">medecin_autour</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Simulation-267"><a href="#Simulation-267"><span class="linenos">267</span></a>
</span><span id="Simulation-268"><a href="#Simulation-268"><span class="linenos">268</span></a>                <span class="n">risque_mort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">taux_letalite</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">)</span>
</span><span id="Simulation-269"><a href="#Simulation-269"><span class="linenos">269</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">immunodeprime</span> <span class="o">==</span> <span class="s2">&quot;oui&quot;</span><span class="p">:</span>
</span><span id="Simulation-270"><a href="#Simulation-270"><span class="linenos">270</span></a>                    <span class="n">risque_mort</span> <span class="o">*=</span> <span class="mf">1.2</span>
</span><span id="Simulation-271"><a href="#Simulation-271"><span class="linenos">271</span></a>                <span class="k">if</span> <span class="n">medecin_autour</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation-272"><a href="#Simulation-272"><span class="linenos">272</span></a>                    <span class="n">risque_mort</span> <span class="o">/=</span> <span class="mi">2</span>
</span><span id="Simulation-273"><a href="#Simulation-273"><span class="linenos">273</span></a>                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">risque_mort</span><span class="p">:</span>
</span><span id="Simulation-274"><a href="#Simulation-274"><span class="linenos">274</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">mourir</span><span class="p">()</span>
</span><span id="Simulation-275"><a href="#Simulation-275"><span class="linenos">275</span></a>                    <span class="k">continue</span>
</span><span id="Simulation-276"><a href="#Simulation-276"><span class="linenos">276</span></a>
</span><span id="Simulation-277"><a href="#Simulation-277"><span class="linenos">277</span></a>                <span class="k">if</span> <span class="n">medecin_autour</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation-278"><a href="#Simulation-278"><span class="linenos">278</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="Simulation-279"><a href="#Simulation-279"><span class="linenos">279</span></a>                <span class="k">else</span> <span class="p">:</span>
</span><span id="Simulation-280"><a href="#Simulation-280"><span class="linenos">280</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation-281"><a href="#Simulation-281"><span class="linenos">281</span></a>
</span><span id="Simulation-282"><a href="#Simulation-282"><span class="linenos">282</span></a>                <span class="n">aleatoire</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="Simulation-283"><a href="#Simulation-283"><span class="linenos">283</span></a>                <span class="k">if</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation-284"><a href="#Simulation-284"><span class="linenos">284</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="Simulation-285"><a href="#Simulation-285"><span class="linenos">285</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation-286"><a href="#Simulation-286"><span class="linenos">286</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation-287"><a href="#Simulation-287"><span class="linenos">287</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">:</span>
</span><span id="Simulation-288"><a href="#Simulation-288"><span class="linenos">288</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Simulation-289"><a href="#Simulation-289"><span class="linenos">289</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">:</span>
</span><span id="Simulation-290"><a href="#Simulation-290"><span class="linenos">290</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">-=</span> <span class="mi">2</span>
</span><span id="Simulation-291"><a href="#Simulation-291"><span class="linenos">291</span></a>
</span><span id="Simulation-292"><a href="#Simulation-292"><span class="linenos">292</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">:</span>
</span><span id="Simulation-293"><a href="#Simulation-293"><span class="linenos">293</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">immunite_apres_guerison</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Simulation-294"><a href="#Simulation-294"><span class="linenos">294</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">etre_immunise</span><span class="p">()</span>
</span><span id="Simulation-295"><a href="#Simulation-295"><span class="linenos">295</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Simulation-296"><a href="#Simulation-296"><span class="linenos">296</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">guerir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">)</span>
</span><span id="Simulation-297"><a href="#Simulation-297"><span class="linenos">297</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-298"><a href="#Simulation-298"><span class="linenos">298</span></a>                    <span class="k">continue</span>
</span><span id="Simulation-299"><a href="#Simulation-299"><span class="linenos">299</span></a>            <span class="k">elif</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s1">&#39;sain&#39;</span> <span class="p">:</span>
</span><span id="Simulation-300"><a href="#Simulation-300"><span class="linenos">300</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation-301"><a href="#Simulation-301"><span class="linenos">301</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Simulation-302"><a href="#Simulation-302"><span class="linenos">302</span></a>            <span class="k">elif</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s1">&#39;mort&#39;</span><span class="p">:</span>
</span><span id="Simulation-303"><a href="#Simulation-303"><span class="linenos">303</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_affichage_apres_mort</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation-304"><a href="#Simulation-304"><span class="linenos">304</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_affichage_apres_mort</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Simulation-305"><a href="#Simulation-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="p">:</span>
</span><span id="Simulation-306"><a href="#Simulation-306"><span class="linenos">306</span></a>            <span class="n">quantite_infectes_relance</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="Simulation-307"><a href="#Simulation-307"><span class="linenos">307</span></a>            <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation-308"><a href="#Simulation-308"><span class="linenos">308</span></a>                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">quantite_infectes_relance</span> <span class="ow">and</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">!=</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="Simulation-309"><a href="#Simulation-309"><span class="linenos">309</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span><span id="Simulation-310"><a href="#Simulation-310"><span class="linenos">310</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation-311"><a href="#Simulation-311"><span class="linenos">311</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="o">*</span><span class="mf">0.75</span>
</span><span id="Simulation-312"><a href="#Simulation-312"><span class="linenos">312</span></a>        <span class="n">nb_morts</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;mort&quot;</span><span class="p">)</span>
</span><span id="Simulation-313"><a href="#Simulation-313"><span class="linenos">313</span></a>        <span class="n">nb_infectes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">)</span>
</span><span id="Simulation-314"><a href="#Simulation-314"><span class="linenos">314</span></a>        <span class="n">nb_total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="Simulation-315"><a href="#Simulation-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_morts</span><span class="p">,</span> <span class="n">nb_total</span><span class="p">]</span>
</span><span id="Simulation-316"><a href="#Simulation-316"><span class="linenos">316</span></a>        <span class="k">if</span> <span class="n">nb_infectes</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation-317"><a href="#Simulation-317"><span class="linenos">317</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation-318"><a href="#Simulation-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
</span></pre></div>


            <div class="docstring"><p>On implémente ensuite la classe simulation, qui permet de construire toute la structure pour la simulation.</p>
</div>


                            <div id="Simulation.__init__" class="classattr">
                                        <input id="Simulation.__init__-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="name">Simulation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">maladie</span>,</span><span class="param">	<span class="n">largeur_fenetre</span>,</span><span class="param">	<span class="n">hauteur_fenetre</span>,</span><span class="param">	<span class="n">duree_cooldown_avant_naissance</span><span class="o">=</span><span class="mi">150</span>,</span><span class="param">	<span class="n">nb_personnes</span><span class="o">=</span><span class="mi">50</span>,</span><span class="param">	<span class="n">taux_naissance</span><span class="o">=</span><span class="mf">0.02</span></span>)</span>

                <label class="view-source-button" for="Simulation.__init__-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.__init__"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.__init__-14"><a href="#Simulation.__init__-14"><span class="linenos">14</span></a>    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">maladie</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">,</span> <span class="n">duree_cooldown_avant_naissance</span> <span class="o">=</span> <span class="mi">150</span><span class="p">,</span> <span class="n">nb_personnes</span><span class="o">=</span><span class="mi">50</span><span class="p">,</span> <span class="n">taux_naissance</span><span class="o">=</span><span class="mf">0.02</span><span class="p">):</span>
</span><span id="Simulation.__init__-15"><a href="#Simulation.__init__-15"><span class="linenos">15</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation.__init__-16"><a href="#Simulation.__init__-16"><span class="linenos">16</span></a><span class="sd">        Nb personnes est le nombre de personnes totales dans la simulation, tout état confondu.</span>
</span><span id="Simulation.__init__-17"><a href="#Simulation.__init__-17"><span class="linenos">17</span></a><span class="sd">        Maladie est l&#39;objet de classe Maladie que la simulation va répandre.</span>
</span><span id="Simulation.__init__-18"><a href="#Simulation.__init__-18"><span class="linenos">18</span></a><span class="sd">        Liste personnes permet de stocker les personnes de la simulation.</span>
</span><span id="Simulation.__init__-19"><a href="#Simulation.__init__-19"><span class="linenos">19</span></a><span class="sd">        On stocke les statistiques qui peuvent servir pour la réalisation des statistiques dans l&#39;attribut df_historique.</span>
</span><span id="Simulation.__init__-20"><a href="#Simulation.__init__-20"><span class="linenos">20</span></a><span class="sd">        On fait le stockage directement dans un dataframe pour que ce soit plus simple pour la réalisation des schémas matplotlib; car c&#39;est la structure priviligiée pour ça.</span>
</span><span id="Simulation.__init__-21"><a href="#Simulation.__init__-21"><span class="linenos">21</span></a><span class="sd">        Iteration est le numéro de l&#39;itération en cours.</span>
</span><span id="Simulation.__init__-22"><a href="#Simulation.__init__-22"><span class="linenos">22</span></a><span class="sd">        Grille est l&#39;objet de classe Grille associé à la simulation.</span>
</span><span id="Simulation.__init__-23"><a href="#Simulation.__init__-23"><span class="linenos">23</span></a><span class="sd">        Taux naissance représente le pourcentage d&#39;enfants nés dans la population.</span>
</span><span id="Simulation.__init__-24"><a href="#Simulation.__init__-24"><span class="linenos">24</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.__init__-25"><a href="#Simulation.__init__-25"><span class="linenos">25</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">nb_personnes</span> <span class="o">=</span> <span class="n">nb_personnes</span>
</span><span id="Simulation.__init__-26"><a href="#Simulation.__init__-26"><span class="linenos">26</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span> <span class="o">=</span> <span class="n">maladie</span>
</span><span id="Simulation.__init__-27"><a href="#Simulation.__init__-27"><span class="linenos">27</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Simulation.__init__-28"><a href="#Simulation.__init__-28"><span class="linenos">28</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;nb_morts&quot;</span><span class="p">,</span> <span class="s2">&quot;nb_total&quot;</span><span class="p">])</span>
</span><span id="Simulation.__init__-29"><a href="#Simulation.__init__-29"><span class="linenos">29</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.__init__-30"><a href="#Simulation.__init__-30"><span class="linenos">30</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">largeur_fenetre</span> <span class="o">=</span> <span class="n">largeur_fenetre</span>
</span><span id="Simulation.__init__-31"><a href="#Simulation.__init__-31"><span class="linenos">31</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">hauteur_fenetre</span> <span class="o">=</span> <span class="n">hauteur_fenetre</span>
</span><span id="Simulation.__init__-32"><a href="#Simulation.__init__-32"><span class="linenos">32</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span> <span class="o">=</span> <span class="n">Grille</span><span class="p">(</span><span class="n">taille_carreau</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">distance_infection</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="o">=</span><span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="o">=</span><span class="n">hauteur_fenetre</span><span class="p">)</span>
</span><span id="Simulation.__init__-33"><a href="#Simulation.__init__-33"><span class="linenos">33</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.__init__-34"><a href="#Simulation.__init__-34"><span class="linenos">34</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">duree_cooldown_avant_naissance</span> <span class="o">=</span> <span class="n">duree_cooldown_avant_naissance</span>
</span><span id="Simulation.__init__-35"><a href="#Simulation.__init__-35"><span class="linenos">35</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">=</span> <span class="n">duree_cooldown_avant_naissance</span>
</span><span id="Simulation.__init__-36"><a href="#Simulation.__init__-36"><span class="linenos">36</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.__init__-37"><a href="#Simulation.__init__-37"><span class="linenos">37</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">taux_naissance</span> <span class="o">=</span> <span class="n">taux_naissance</span>
</span></pre></div>


            <div class="docstring"><p>Nb personnes est le nombre de personnes totales dans la simulation, tout état confondu.
Maladie est l'objet de classe Maladie que la simulation va répandre.
Liste personnes permet de stocker les personnes de la simulation.
On stocke les statistiques qui peuvent servir pour la réalisation des statistiques dans l'attribut df_historique.
On fait le stockage directement dans un dataframe pour que ce soit plus simple pour la réalisation des schémas matplotlib; car c'est la structure priviligiée pour ça.
Iteration est le numéro de l'itération en cours.
Grille est l'objet de classe Grille associé à la simulation.
Taux naissance représente le pourcentage d'enfants nés dans la population.</p>
</div>


                            </div>
                            <div id="Simulation.nb_personnes" class="classattr">
                                <div class="attr variable">
            <span class="name">nb_personnes</span>

        
    </div>
    <a class="headerlink" href="#Simulation.nb_personnes"></a>
    
    

                            </div>
                            <div id="Simulation.maladie" class="classattr">
                                <div class="attr variable">
            <span class="name">maladie</span>

        
    </div>
    <a class="headerlink" href="#Simulation.maladie"></a>
    
    

                            </div>
                            <div id="Simulation.liste_personnes" class="classattr">
                                <div class="attr variable">
            <span class="name">liste_personnes</span>

        
    </div>
    <a class="headerlink" href="#Simulation.liste_personnes"></a>
    
    

                            </div>
                            <div id="Simulation.df_historique" class="classattr">
                                <div class="attr variable">
            <span class="name">df_historique</span>

        
    </div>
    <a class="headerlink" href="#Simulation.df_historique"></a>
    
    

                            </div>
                            <div id="Simulation.iterations" class="classattr">
                                <div class="attr variable">
            <span class="name">iterations</span>

        
    </div>
    <a class="headerlink" href="#Simulation.iterations"></a>
    
    

                            </div>
                            <div id="Simulation.largeur_fenetre" class="classattr">
                                <div class="attr variable">
            <span class="name">largeur_fenetre</span>

        
    </div>
    <a class="headerlink" href="#Simulation.largeur_fenetre"></a>
    
    

                            </div>
                            <div id="Simulation.hauteur_fenetre" class="classattr">
                                <div class="attr variable">
            <span class="name">hauteur_fenetre</span>

        
    </div>
    <a class="headerlink" href="#Simulation.hauteur_fenetre"></a>
    
    

                            </div>
                            <div id="Simulation.grille" class="classattr">
                                <div class="attr variable">
            <span class="name">grille</span>

        
    </div>
    <a class="headerlink" href="#Simulation.grille"></a>
    
    

                            </div>
                            <div id="Simulation.iterations_sans_infecte" class="classattr">
                                <div class="attr variable">
            <span class="name">iterations_sans_infecte</span>

        
    </div>
    <a class="headerlink" href="#Simulation.iterations_sans_infecte"></a>
    
    

                            </div>
                            <div id="Simulation.duree_cooldown_avant_naissance" class="classattr">
                                <div class="attr variable">
            <span class="name">duree_cooldown_avant_naissance</span>

        
    </div>
    <a class="headerlink" href="#Simulation.duree_cooldown_avant_naissance"></a>
    
    

                            </div>
                            <div id="Simulation.cooldown_avant_naissance" class="classattr">
                                <div class="attr variable">
            <span class="name">cooldown_avant_naissance</span>

        
    </div>
    <a class="headerlink" href="#Simulation.cooldown_avant_naissance"></a>
    
    

                            </div>
                            <div id="Simulation.pourcentage_immunodeprimes" class="classattr">
                                <div class="attr variable">
            <span class="name">pourcentage_immunodeprimes</span>

        
    </div>
    <a class="headerlink" href="#Simulation.pourcentage_immunodeprimes"></a>
    
    

                            </div>
                            <div id="Simulation.taux_naissance" class="classattr">
                                <div class="attr variable">
            <span class="name">taux_naissance</span>

        
    </div>
    <a class="headerlink" href="#Simulation.taux_naissance"></a>
    
    

                            </div>
                            <div id="Simulation.initialiser_population" class="classattr">
                                        <input id="Simulation.initialiser_population-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">initialiser_population</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="bp">self</span>,</span><span class="param">	<span class="n">largeur_fenetre</span>,</span><span class="param">	<span class="n">hauteur_fenetre</span>,</span><span class="param">	<span class="n">pourcentage_infectes</span><span class="o">=</span><span class="mi">5</span>,</span><span class="param">	<span class="n">pourcentage_immunodeprimes</span><span class="o">=</span><span class="mi">5</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simulation.initialiser_population-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.initialiser_population"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.initialiser_population-39"><a href="#Simulation.initialiser_population-39"><span class="linenos">39</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">initialiser_population</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">,</span> <span class="n">pourcentage_infectes</span> <span class="o">=</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="mi">5</span><span class="p">):</span>
</span><span id="Simulation.initialiser_population-40"><a href="#Simulation.initialiser_population-40"><span class="linenos">40</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation.initialiser_population-41"><a href="#Simulation.initialiser_population-41"><span class="linenos">41</span></a><span class="sd">        On crée les personnes de la simulation et on infecte un échantillon.</span>
</span><span id="Simulation.initialiser_population-42"><a href="#Simulation.initialiser_population-42"><span class="linenos">42</span></a><span class="sd">        Par défaut, on met le pourcentage de personnes infectées à 5% mais l&#39;utilisateur peut règler cette valeur.</span>
</span><span id="Simulation.initialiser_population-43"><a href="#Simulation.initialiser_population-43"><span class="linenos">43</span></a><span class="sd">        Il y a également un indicateur du pourcentage que représentent les personnes immunodéprimées parmi la population.</span>
</span><span id="Simulation.initialiser_population-44"><a href="#Simulation.initialiser_population-44"><span class="linenos">44</span></a><span class="sd">        On va initialiser chaque personne à une position aléatoire dans la fenêtre.</span>
</span><span id="Simulation.initialiser_population-45"><a href="#Simulation.initialiser_population-45"><span class="linenos">45</span></a><span class="sd">        On utilise randint pour tirer aléatoirement les chances qu&#39;une personne soit immunodéprimée.</span>
</span><span id="Simulation.initialiser_population-46"><a href="#Simulation.initialiser_population-46"><span class="linenos">46</span></a><span class="sd">        Ensuite, on infecte le pourcentage de personnes infectées choisi par la personne.</span>
</span><span id="Simulation.initialiser_population-47"><a href="#Simulation.initialiser_population-47"><span class="linenos">47</span></a><span class="sd">        Pour cela, on tire aléatoirement le nombre de personnes qu&#39;il faut.</span>
</span><span id="Simulation.initialiser_population-48"><a href="#Simulation.initialiser_population-48"><span class="linenos">48</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.initialiser_population-49"><a href="#Simulation.initialiser_population-49"><span class="linenos">49</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nb_personnes</span><span class="p">):</span>
</span><span id="Simulation.initialiser_population-50"><a href="#Simulation.initialiser_population-50"><span class="linenos">50</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">largeur_fenetre</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">hauteur_fenetre</span><span class="p">)]</span>
</span><span id="Simulation.initialiser_population-51"><a href="#Simulation.initialiser_population-51"><span class="linenos">51</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="n">pourcentage_immunodeprimes</span><span class="p">:</span>
</span><span id="Simulation.initialiser_population-52"><a href="#Simulation.initialiser_population-52"><span class="linenos">52</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;oui&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="Simulation.initialiser_population-53"><a href="#Simulation.initialiser_population-53"><span class="linenos">53</span></a>            <span class="k">else</span> <span class="p">:</span>
</span><span id="Simulation.initialiser_population-54"><a href="#Simulation.initialiser_population-54"><span class="linenos">54</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;non&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="Simulation.initialiser_population-55"><a href="#Simulation.initialiser_population-55"><span class="linenos">55</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="Simulation.initialiser_population-56"><a href="#Simulation.initialiser_population-56"><span class="linenos">56</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation.initialiser_population-57"><a href="#Simulation.initialiser_population-57"><span class="linenos">57</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">pourcentage_infectes</span><span class="p">:</span>
</span><span id="Simulation.initialiser_population-58"><a href="#Simulation.initialiser_population-58"><span class="linenos">58</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span><span id="Simulation.initialiser_population-59"><a href="#Simulation.initialiser_population-59"><span class="linenos">59</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Simulation.initialiser_population-60"><a href="#Simulation.initialiser_population-60"><span class="linenos">60</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_medecin</span><span class="p">()</span>
</span><span id="Simulation.initialiser_population-61"><a href="#Simulation.initialiser_population-61"><span class="linenos">61</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span> <span class="o">=</span> <span class="n">pourcentage_immunodeprimes</span>
</span><span id="Simulation.initialiser_population-62"><a href="#Simulation.initialiser_population-62"><span class="linenos">62</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>On crée les personnes de la simulation et on infecte un échantillon.
Par défaut, on met le pourcentage de personnes infectées à 5% mais l'utilisateur peut règler cette valeur.
Il y a également un indicateur du pourcentage que représentent les personnes immunodéprimées parmi la population.
On va initialiser chaque personne à une position aléatoire dans la fenêtre.
On utilise randint pour tirer aléatoirement les chances qu'une personne soit immunodéprimée.
Ensuite, on infecte le pourcentage de personnes infectées choisi par la personne.
Pour cela, on tire aléatoirement le nombre de personnes qu'il faut.</p>
</div>


                            </div>
                            <div id="Simulation.propager_infection" class="classattr">
                                        <input id="Simulation.propager_infection-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">propager_infection</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simulation.propager_infection-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.propager_infection"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.propager_infection-64"><a href="#Simulation.propager_infection-64"><span class="linenos">64</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">propager_infection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation.propager_infection-65"><a href="#Simulation.propager_infection-65"><span class="linenos">65</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation.propager_infection-66"><a href="#Simulation.propager_infection-66"><span class="linenos">66</span></a><span class="sd">        On fait la propagation de la maladie aux personnes à côté d&#39;une personne infectée.</span>
</span><span id="Simulation.propager_infection-67"><a href="#Simulation.propager_infection-67"><span class="linenos">67</span></a><span class="sd">        Pour chaque personne infectée, on récupère ses voisins, donc ceux dans sa case de la grille ou les 8 cas autour.</span>
</span><span id="Simulation.propager_infection-68"><a href="#Simulation.propager_infection-68"><span class="linenos">68</span></a><span class="sd">        On regarde si la distance entre les deux points est assez faible pour que la personne puisse être infectée.</span>
</span><span id="Simulation.propager_infection-69"><a href="#Simulation.propager_infection-69"><span class="linenos">69</span></a><span class="sd">        Comme la valeur de risque de transmission est un entier entre 1 et 100, on va récupérer une valeur aléatoire.</span>
</span><span id="Simulation.propager_infection-70"><a href="#Simulation.propager_infection-70"><span class="linenos">70</span></a><span class="sd">        Si elle est inférieure au pourcentage de risque de transmission, la personne est maintenant infectée.</span>
</span><span id="Simulation.propager_infection-71"><a href="#Simulation.propager_infection-71"><span class="linenos">71</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.propager_infection-72"><a href="#Simulation.propager_infection-72"><span class="linenos">72</span></a>        <span class="n">infectes</span> <span class="o">=</span> <span class="p">[</span><span class="n">personne</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">]</span>
</span><span id="Simulation.propager_infection-73"><a href="#Simulation.propager_infection-73"><span class="linenos">73</span></a>        <span class="k">for</span> <span class="n">infecte</span> <span class="ow">in</span> <span class="n">infectes</span><span class="p">:</span>
</span><span id="Simulation.propager_infection-74"><a href="#Simulation.propager_infection-74"><span class="linenos">74</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">infecte</span><span class="p">)</span>
</span><span id="Simulation.propager_infection-75"><a href="#Simulation.propager_infection-75"><span class="linenos">75</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="p">[</span><span class="n">personne</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="n">voisins</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;sain&quot;</span><span class="p">]</span>
</span><span id="Simulation.propager_infection-76"><a href="#Simulation.propager_infection-76"><span class="linenos">76</span></a>            <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span> <span class="p">:</span>
</span><span id="Simulation.propager_infection-77"><a href="#Simulation.propager_infection-77"><span class="linenos">77</span></a>                <span class="k">if</span> <span class="n">voisin</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation.propager_infection-78"><a href="#Simulation.propager_infection-78"><span class="linenos">78</span></a>                    <span class="k">if</span> <span class="n">infecte</span><span class="o">.</span><span class="n">etre_en_contact</span><span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">distance_infection</span><span class="p">):</span>
</span><span id="Simulation.propager_infection-79"><a href="#Simulation.propager_infection-79"><span class="linenos">79</span></a>                        <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">risque_transmission</span><span class="p">:</span>
</span><span id="Simulation.propager_infection-80"><a href="#Simulation.propager_infection-80"><span class="linenos">80</span></a>                            <span class="n">voisin</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span></pre></div>


            <div class="docstring"><p>On fait la propagation de la maladie aux personnes à côté d'une personne infectée.
Pour chaque personne infectée, on récupère ses voisins, donc ceux dans sa case de la grille ou les 8 cas autour.
On regarde si la distance entre les deux points est assez faible pour que la personne puisse être infectée.
Comme la valeur de risque de transmission est un entier entre 1 et 100, on va récupérer une valeur aléatoire.
Si elle est inférieure au pourcentage de risque de transmission, la personne est maintenant infectée.</p>
</div>


                            </div>
                            <div id="Simulation.deplacements_aleatoires" class="classattr">
                                        <input id="Simulation.deplacements_aleatoires-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">deplacements_aleatoires</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simulation.deplacements_aleatoires-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.deplacements_aleatoires"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.deplacements_aleatoires-82"><a href="#Simulation.deplacements_aleatoires-82"><span class="linenos"> 82</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacements_aleatoires</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation.deplacements_aleatoires-83"><a href="#Simulation.deplacements_aleatoires-83"><span class="linenos"> 83</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation.deplacements_aleatoires-84"><a href="#Simulation.deplacements_aleatoires-84"><span class="linenos"> 84</span></a><span class="sd">        On fait se déplacer chaque personne de manière totalement aléatoire, pour ça on ajoute une petite variation en x et en y, dans un intervalle défini.</span>
</span><span id="Simulation.deplacements_aleatoires-85"><a href="#Simulation.deplacements_aleatoires-85"><span class="linenos"> 85</span></a><span class="sd">        On vérifie ensuite que la nouvelle position reste dans les limites de la fenêtre : si la personne dépasse le bord, on la replace exactement sur la limite.</span>
</span><span id="Simulation.deplacements_aleatoires-86"><a href="#Simulation.deplacements_aleatoires-86"><span class="linenos"> 86</span></a><span class="sd">        Finalement, on met à jour la position et on reconstruit la grille pour la prochaine itération.</span>
</span><span id="Simulation.deplacements_aleatoires-87"><a href="#Simulation.deplacements_aleatoires-87"><span class="linenos"> 87</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.deplacements_aleatoires-88"><a href="#Simulation.deplacements_aleatoires-88"><span class="linenos"> 88</span></a>        <span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">()</span>
</span><span id="Simulation.deplacements_aleatoires-89"><a href="#Simulation.deplacements_aleatoires-89"><span class="linenos"> 89</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation.deplacements_aleatoires-90"><a href="#Simulation.deplacements_aleatoires-90"><span class="linenos"> 90</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="Simulation.deplacements_aleatoires-91"><a href="#Simulation.deplacements_aleatoires-91"><span class="linenos"> 91</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">random</span><span class="o">.</span><span class="n">randrange</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
</span><span id="Simulation.deplacements_aleatoires-92"><a href="#Simulation.deplacements_aleatoires-92"><span class="linenos"> 92</span></a>            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation.deplacements_aleatoires-93"><a href="#Simulation.deplacements_aleatoires-93"><span class="linenos"> 93</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.deplacements_aleatoires-94"><a href="#Simulation.deplacements_aleatoires-94"><span class="linenos"> 94</span></a>            <span class="k">elif</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span> <span class="p">:</span>
</span><span id="Simulation.deplacements_aleatoires-95"><a href="#Simulation.deplacements_aleatoires-95"><span class="linenos"> 95</span></a>                <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span>
</span><span id="Simulation.deplacements_aleatoires-96"><a href="#Simulation.deplacements_aleatoires-96"><span class="linenos"> 96</span></a>            <span class="k">if</span> <span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation.deplacements_aleatoires-97"><a href="#Simulation.deplacements_aleatoires-97"><span class="linenos"> 97</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.deplacements_aleatoires-98"><a href="#Simulation.deplacements_aleatoires-98"><span class="linenos"> 98</span></a>            <span class="k">elif</span> <span class="n">y</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span> <span class="p">:</span>
</span><span id="Simulation.deplacements_aleatoires-99"><a href="#Simulation.deplacements_aleatoires-99"><span class="linenos"> 99</span></a>                <span class="n">y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span>
</span><span id="Simulation.deplacements_aleatoires-100"><a href="#Simulation.deplacements_aleatoires-100"><span class="linenos">100</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="Simulation.deplacements_aleatoires-101"><a href="#Simulation.deplacements_aleatoires-101"><span class="linenos">101</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>On fait se déplacer chaque personne de manière totalement aléatoire, pour ça on ajoute une petite variation en x et en y, dans un intervalle défini.
On vérifie ensuite que la nouvelle position reste dans les limites de la fenêtre : si la personne dépasse le bord, on la replace exactement sur la limite.
Finalement, on met à jour la position et on reconstruit la grille pour la prochaine itération.</p>
</div>


                            </div>
                            <div id="Simulation.deplacements_grille" class="classattr">
                                        <input id="Simulation.deplacements_grille-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">deplacements_grille</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simulation.deplacements_grille-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.deplacements_grille"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.deplacements_grille-103"><a href="#Simulation.deplacements_grille-103"><span class="linenos">103</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacements_grille</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation.deplacements_grille-104"><a href="#Simulation.deplacements_grille-104"><span class="linenos">104</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation.deplacements_grille-105"><a href="#Simulation.deplacements_grille-105"><span class="linenos">105</span></a><span class="sd">        Chaque personne choisit un carreau voisin au hasard et se déplace si ce carreau est disponible</span>
</span><span id="Simulation.deplacements_grille-106"><a href="#Simulation.deplacements_grille-106"><span class="linenos">106</span></a><span class="sd">        À l&#39;intérieur du carreau, la position est légèrement aléatoire pour éviter que tout le monde soit exactement au centre.</span>
</span><span id="Simulation.deplacements_grille-107"><a href="#Simulation.deplacements_grille-107"><span class="linenos">107</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.deplacements_grille-108"><a href="#Simulation.deplacements_grille-108"><span class="linenos">108</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Simulation.deplacements_grille-109"><a href="#Simulation.deplacements_grille-109"><span class="linenos">109</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation.deplacements_grille-110"><a href="#Simulation.deplacements_grille-110"><span class="linenos">110</span></a>            <span class="n">carreau_x</span><span class="p">,</span> <span class="n">carreau_y</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">coordonnees_carreau</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">)</span>
</span><span id="Simulation.deplacements_grille-111"><a href="#Simulation.deplacements_grille-111"><span class="linenos">111</span></a>            <span class="n">direction_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Simulation.deplacements_grille-112"><a href="#Simulation.deplacements_grille-112"><span class="linenos">112</span></a>            <span class="n">direction_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
</span><span id="Simulation.deplacements_grille-113"><a href="#Simulation.deplacements_grille-113"><span class="linenos">113</span></a>            <span class="n">nouveau_carreau_x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">carreau_x</span> <span class="o">+</span> <span class="n">direction_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">nb_colonnes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Simulation.deplacements_grille-114"><a href="#Simulation.deplacements_grille-114"><span class="linenos">114</span></a>            <span class="n">nouveau_carreau_y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">carreau_y</span> <span class="o">+</span> <span class="n">direction_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">nb_lignes</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
</span><span id="Simulation.deplacements_grille-115"><a href="#Simulation.deplacements_grille-115"><span class="linenos">115</span></a>            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">carreaux</span><span class="p">[</span><span class="n">nouveau_carreau_x</span><span class="p">][</span><span class="n">nouveau_carreau_y</span><span class="p">]:</span>
</span><span id="Simulation.deplacements_grille-116"><a href="#Simulation.deplacements_grille-116"><span class="linenos">116</span></a>                <span class="n">deplacement_x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation.deplacements_grille-117"><a href="#Simulation.deplacements_grille-117"><span class="linenos">117</span></a>                <span class="n">deplacement_y</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation.deplacements_grille-118"><a href="#Simulation.deplacements_grille-118"><span class="linenos">118</span></a>            <span class="k">else</span><span class="p">:</span>
</span><span id="Simulation.deplacements_grille-119"><a href="#Simulation.deplacements_grille-119"><span class="linenos">119</span></a>                <span class="n">deplacement_x</span><span class="p">,</span> <span class="n">deplacement_y</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>
</span><span id="Simulation.deplacements_grille-120"><a href="#Simulation.deplacements_grille-120"><span class="linenos">120</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nouveau_carreau_x</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span> <span class="o">+</span> <span class="n">deplacement_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="Simulation.deplacements_grille-121"><a href="#Simulation.deplacements_grille-121"><span class="linenos">121</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="n">nouveau_carreau_y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">taille_carreau</span> <span class="o">+</span> <span class="n">deplacement_y</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="Simulation.deplacements_grille-122"><a href="#Simulation.deplacements_grille-122"><span class="linenos">122</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="Simulation.deplacements_grille-123"><a href="#Simulation.deplacements_grille-123"><span class="linenos">123</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="Simulation.deplacements_grille-124"><a href="#Simulation.deplacements_grille-124"><span class="linenos">124</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="Simulation.deplacements_grille-125"><a href="#Simulation.deplacements_grille-125"><span class="linenos">125</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Chaque personne choisit un carreau voisin au hasard et se déplace si ce carreau est disponible
À l'intérieur du carreau, la position est légèrement aléatoire pour éviter que tout le monde soit exactement au centre.</p>
</div>


                            </div>
                            <div id="Simulation.deplacement_stochastique_directionnel" class="classattr">
                                        <input id="Simulation.deplacement_stochastique_directionnel-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">deplacement_stochastique_directionnel</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simulation.deplacement_stochastique_directionnel-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.deplacement_stochastique_directionnel"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.deplacement_stochastique_directionnel-127"><a href="#Simulation.deplacement_stochastique_directionnel-127"><span class="linenos">127</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacement_stochastique_directionnel</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-128"><a href="#Simulation.deplacement_stochastique_directionnel-128"><span class="linenos">128</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-129"><a href="#Simulation.deplacement_stochastique_directionnel-129"><span class="linenos">129</span></a><span class="sd">        Chaque personne garde une direction générale qui change un peu entre chaque itération avec du hasard</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-130"><a href="#Simulation.deplacement_stochastique_directionnel-130"><span class="linenos">130</span></a><span class="sd">        S&#39;il y a des clusters fort proche de la personne, on limite l&#39;attractivité de la direction, pour éviter des regroupements trop massifs.</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-131"><a href="#Simulation.deplacement_stochastique_directionnel-131"><span class="linenos">131</span></a><span class="sd">        Cela permet d&#39;avoir de la cohésion mais garder quand même des directions qui sont influencées par les voisins sans centrer tout le monde en un point.</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-132"><a href="#Simulation.deplacement_stochastique_directionnel-132"><span class="linenos">132</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-133"><a href="#Simulation.deplacement_stochastique_directionnel-133"><span class="linenos">133</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-134"><a href="#Simulation.deplacement_stochastique_directionnel-134"><span class="linenos">134</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-135"><a href="#Simulation.deplacement_stochastique_directionnel-135"><span class="linenos">135</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">personne</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">):</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-136"><a href="#Simulation.deplacement_stochastique_directionnel-136"><span class="linenos">136</span></a>                <span class="n">angle</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-137"><a href="#Simulation.deplacement_stochastique_directionnel-137"><span class="linenos">137</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-138"><a href="#Simulation.deplacement_stochastique_directionnel-138"><span class="linenos">138</span></a>            <span class="n">densite</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">))</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-139"><a href="#Simulation.deplacement_stochastique_directionnel-139"><span class="linenos">139</span></a>            <span class="n">exploration</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)]</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-140"><a href="#Simulation.deplacement_stochastique_directionnel-140"><span class="linenos">140</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">densite</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-141"><a href="#Simulation.deplacement_stochastique_directionnel-141"><span class="linenos">141</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.7</span> <span class="o">*</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.01</span> <span class="o">*</span> <span class="n">densite</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-142"><a href="#Simulation.deplacement_stochastique_directionnel-142"><span class="linenos">142</span></a>            <span class="n">norme</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-143"><a href="#Simulation.deplacement_stochastique_directionnel-143"><span class="linenos">143</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-144"><a href="#Simulation.deplacement_stochastique_directionnel-144"><span class="linenos">144</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-145"><a href="#Simulation.deplacement_stochastique_directionnel-145"><span class="linenos">145</span></a>            <span class="n">pas</span> <span class="o">=</span> <span class="mi">10</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-146"><a href="#Simulation.deplacement_stochastique_directionnel-146"><span class="linenos">146</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-147"><a href="#Simulation.deplacement_stochastique_directionnel-147"><span class="linenos">147</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-148"><a href="#Simulation.deplacement_stochastique_directionnel-148"><span class="linenos">148</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-149"><a href="#Simulation.deplacement_stochastique_directionnel-149"><span class="linenos">149</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-150"><a href="#Simulation.deplacement_stochastique_directionnel-150"><span class="linenos">150</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-151"><a href="#Simulation.deplacement_stochastique_directionnel-151"><span class="linenos">151</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-152"><a href="#Simulation.deplacement_stochastique_directionnel-152"><span class="linenos">152</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="Simulation.deplacement_stochastique_directionnel-153"><a href="#Simulation.deplacement_stochastique_directionnel-153"><span class="linenos">153</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Chaque personne garde une direction générale qui change un peu entre chaque itération avec du hasard
S'il y a des clusters fort proche de la personne, on limite l'attractivité de la direction, pour éviter des regroupements trop massifs.
Cela permet d'avoir de la cohésion mais garder quand même des directions qui sont influencées par les voisins sans centrer tout le monde en un point.</p>
</div>


                            </div>
                            <div id="Simulation.deplacement_boids_simplifie" class="classattr">
                                        <input id="Simulation.deplacement_boids_simplifie-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">deplacement_boids_simplifie</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simulation.deplacement_boids_simplifie-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.deplacement_boids_simplifie"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.deplacement_boids_simplifie-155"><a href="#Simulation.deplacement_boids_simplifie-155"><span class="linenos">155</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">deplacement_boids_simplifie</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation.deplacement_boids_simplifie-156"><a href="#Simulation.deplacement_boids_simplifie-156"><span class="linenos">156</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot; </span>
</span><span id="Simulation.deplacement_boids_simplifie-157"><a href="#Simulation.deplacement_boids_simplifie-157"><span class="linenos">157</span></a><span class="sd">        Cette méthode met à jour la direction des personnes en utilisant deux des trois principes de Boids.</span>
</span><span id="Simulation.deplacement_boids_simplifie-158"><a href="#Simulation.deplacement_boids_simplifie-158"><span class="linenos">158</span></a><span class="sd">        D&#39;abord, on calcule un point moyen des voisins proches pour ajuster légèrement la direction vers ce point.</span>
</span><span id="Simulation.deplacement_boids_simplifie-159"><a href="#Simulation.deplacement_boids_simplifie-159"><span class="linenos">159</span></a><span class="sd">        Ensuite, on ajoute une force de répulsion si des voisins sont trop proches pour éviter qu&#39;ils se stackent.</span>
</span><span id="Simulation.deplacement_boids_simplifie-160"><a href="#Simulation.deplacement_boids_simplifie-160"><span class="linenos">160</span></a><span class="sd">        On ajoute aussi une petite valeur aléatoire pour modifier légèrement la direction à chaque étape.</span>
</span><span id="Simulation.deplacement_boids_simplifie-161"><a href="#Simulation.deplacement_boids_simplifie-161"><span class="linenos">161</span></a><span class="sd">        Enfin, on applique un poids aux murs pour qu&#39;ils qui poussent les personnes vers l&#39;intérieur lorsqu&#39;elles s&#39;approchent trop pour éviter les regroupement contre les murs.</span>
</span><span id="Simulation.deplacement_boids_simplifie-162"><a href="#Simulation.deplacement_boids_simplifie-162"><span class="linenos">162</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.deplacement_boids_simplifie-163"><a href="#Simulation.deplacement_boids_simplifie-163"><span class="linenos">163</span></a>        <span class="n">nouvelle_positions</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="Simulation.deplacement_boids_simplifie-164"><a href="#Simulation.deplacement_boids_simplifie-164"><span class="linenos">164</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-165"><a href="#Simulation.deplacement_boids_simplifie-165"><span class="linenos">165</span></a>            <span class="k">if</span> <span class="ow">not</span> <span class="nb">hasattr</span><span class="p">(</span><span class="n">personne</span><span class="p">,</span> <span class="s2">&quot;direction&quot;</span><span class="p">):</span>
</span><span id="Simulation.deplacement_boids_simplifie-166"><a href="#Simulation.deplacement_boids_simplifie-166"><span class="linenos">166</span></a>                <span class="n">angle</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">math</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span>
</span><span id="Simulation.deplacement_boids_simplifie-167"><a href="#Simulation.deplacement_boids_simplifie-167"><span class="linenos">167</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="p">[</span><span class="n">math</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">math</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">)]</span>
</span><span id="Simulation.deplacement_boids_simplifie-168"><a href="#Simulation.deplacement_boids_simplifie-168"><span class="linenos">168</span></a>            <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="Simulation.deplacement_boids_simplifie-169"><a href="#Simulation.deplacement_boids_simplifie-169"><span class="linenos">169</span></a>            <span class="n">centre_voisins</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation.deplacement_boids_simplifie-170"><a href="#Simulation.deplacement_boids_simplifie-170"><span class="linenos">170</span></a>            <span class="n">repulsion</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation.deplacement_boids_simplifie-171"><a href="#Simulation.deplacement_boids_simplifie-171"><span class="linenos">171</span></a>            <span class="n">compteur_centre</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.deplacement_boids_simplifie-172"><a href="#Simulation.deplacement_boids_simplifie-172"><span class="linenos">172</span></a>            <span class="n">compteur_repulsion</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.deplacement_boids_simplifie-173"><a href="#Simulation.deplacement_boids_simplifie-173"><span class="linenos">173</span></a>            <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-174"><a href="#Simulation.deplacement_boids_simplifie-174"><span class="linenos">174</span></a>                <span class="k">if</span> <span class="n">voisin</span> <span class="ow">is</span> <span class="n">personne</span> <span class="ow">or</span> <span class="n">voisin</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-175"><a href="#Simulation.deplacement_boids_simplifie-175"><span class="linenos">175</span></a>                    <span class="k">continue</span>
</span><span id="Simulation.deplacement_boids_simplifie-176"><a href="#Simulation.deplacement_boids_simplifie-176"><span class="linenos">176</span></a>                <span class="n">direction_x</span> <span class="o">=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation.deplacement_boids_simplifie-177"><a href="#Simulation.deplacement_boids_simplifie-177"><span class="linenos">177</span></a>                <span class="n">direction_y</span> <span class="o">=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Simulation.deplacement_boids_simplifie-178"><a href="#Simulation.deplacement_boids_simplifie-178"><span class="linenos">178</span></a>                <span class="n">distance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">direction_x</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">direction_y</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation.deplacement_boids_simplifie-179"><a href="#Simulation.deplacement_boids_simplifie-179"><span class="linenos">179</span></a>                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="mi">50</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-180"><a href="#Simulation.deplacement_boids_simplifie-180"><span class="linenos">180</span></a>                    <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation.deplacement_boids_simplifie-181"><a href="#Simulation.deplacement_boids_simplifie-181"><span class="linenos">181</span></a>                    <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Simulation.deplacement_boids_simplifie-182"><a href="#Simulation.deplacement_boids_simplifie-182"><span class="linenos">182</span></a>                    <span class="n">compteur_centre</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation.deplacement_boids_simplifie-183"><a href="#Simulation.deplacement_boids_simplifie-183"><span class="linenos">183</span></a>                <span class="k">if</span> <span class="n">distance</span> <span class="o">&lt;</span> <span class="mi">15</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-184"><a href="#Simulation.deplacement_boids_simplifie-184"><span class="linenos">184</span></a>                    <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</span><span id="Simulation.deplacement_boids_simplifie-185"><a href="#Simulation.deplacement_boids_simplifie-185"><span class="linenos">185</span></a>                    <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="p">(</span><span class="n">voisin</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
</span><span id="Simulation.deplacement_boids_simplifie-186"><a href="#Simulation.deplacement_boids_simplifie-186"><span class="linenos">186</span></a>                    <span class="n">compteur_repulsion</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation.deplacement_boids_simplifie-187"><a href="#Simulation.deplacement_boids_simplifie-187"><span class="linenos">187</span></a>            <span class="k">if</span> <span class="n">compteur_centre</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-188"><a href="#Simulation.deplacement_boids_simplifie-188"><span class="linenos">188</span></a>                <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_centre</span>
</span><span id="Simulation.deplacement_boids_simplifie-189"><a href="#Simulation.deplacement_boids_simplifie-189"><span class="linenos">189</span></a>                <span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_centre</span>
</span><span id="Simulation.deplacement_boids_simplifie-190"><a href="#Simulation.deplacement_boids_simplifie-190"><span class="linenos">190</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">centre_voisins</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.0015</span>
</span><span id="Simulation.deplacement_boids_simplifie-191"><a href="#Simulation.deplacement_boids_simplifie-191"><span class="linenos">191</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="p">(</span><span class="n">centre_voisins</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">*</span> <span class="mf">0.0015</span>
</span><span id="Simulation.deplacement_boids_simplifie-192"><a href="#Simulation.deplacement_boids_simplifie-192"><span class="linenos">192</span></a>            <span class="k">if</span> <span class="n">compteur_repulsion</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-193"><a href="#Simulation.deplacement_boids_simplifie-193"><span class="linenos">193</span></a>                <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_repulsion</span>
</span><span id="Simulation.deplacement_boids_simplifie-194"><a href="#Simulation.deplacement_boids_simplifie-194"><span class="linenos">194</span></a>                <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">compteur_repulsion</span>
</span><span id="Simulation.deplacement_boids_simplifie-195"><a href="#Simulation.deplacement_boids_simplifie-195"><span class="linenos">195</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">repulsion</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.05</span>
</span><span id="Simulation.deplacement_boids_simplifie-196"><a href="#Simulation.deplacement_boids_simplifie-196"><span class="linenos">196</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">repulsion</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="mf">0.05</span>
</span><span id="Simulation.deplacement_boids_simplifie-197"><a href="#Simulation.deplacement_boids_simplifie-197"><span class="linenos">197</span></a>            <span class="n">exploration</span> <span class="o">=</span> <span class="p">[</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">),</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="o">-</span><span class="mf">0.05</span><span class="p">,</span> <span class="mf">0.05</span><span class="p">)]</span>
</span><span id="Simulation.deplacement_boids_simplifie-198"><a href="#Simulation.deplacement_boids_simplifie-198"><span class="linenos">198</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation.deplacement_boids_simplifie-199"><a href="#Simulation.deplacement_boids_simplifie-199"><span class="linenos">199</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">exploration</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</span><span id="Simulation.deplacement_boids_simplifie-200"><a href="#Simulation.deplacement_boids_simplifie-200"><span class="linenos">200</span></a>            <span class="n">marge</span> <span class="o">=</span> <span class="mi">20</span>
</span><span id="Simulation.deplacement_boids_simplifie-201"><a href="#Simulation.deplacement_boids_simplifie-201"><span class="linenos">201</span></a>            <span class="n">force_mur</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Simulation.deplacement_boids_simplifie-202"><a href="#Simulation.deplacement_boids_simplifie-202"><span class="linenos">202</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-203"><a href="#Simulation.deplacement_boids_simplifie-203"><span class="linenos">203</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">force_mur</span>
</span><span id="Simulation.deplacement_boids_simplifie-204"><a href="#Simulation.deplacement_boids_simplifie-204"><span class="linenos">204</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span> <span class="o">-</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-205"><a href="#Simulation.deplacement_boids_simplifie-205"><span class="linenos">205</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-=</span> <span class="n">force_mur</span>
</span><span id="Simulation.deplacement_boids_simplifie-206"><a href="#Simulation.deplacement_boids_simplifie-206"><span class="linenos">206</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-207"><a href="#Simulation.deplacement_boids_simplifie-207"><span class="linenos">207</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">force_mur</span>
</span><span id="Simulation.deplacement_boids_simplifie-208"><a href="#Simulation.deplacement_boids_simplifie-208"><span class="linenos">208</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span> <span class="o">-</span> <span class="n">marge</span><span class="p">:</span>
</span><span id="Simulation.deplacement_boids_simplifie-209"><a href="#Simulation.deplacement_boids_simplifie-209"><span class="linenos">209</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-=</span> <span class="n">force_mur</span>
</span><span id="Simulation.deplacement_boids_simplifie-210"><a href="#Simulation.deplacement_boids_simplifie-210"><span class="linenos">210</span></a>            <span class="n">norme</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</span><span id="Simulation.deplacement_boids_simplifie-211"><a href="#Simulation.deplacement_boids_simplifie-211"><span class="linenos">211</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="Simulation.deplacement_boids_simplifie-212"><a href="#Simulation.deplacement_boids_simplifie-212"><span class="linenos">212</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">/=</span> <span class="n">norme</span>
</span><span id="Simulation.deplacement_boids_simplifie-213"><a href="#Simulation.deplacement_boids_simplifie-213"><span class="linenos">213</span></a>            <span class="n">pas</span> <span class="o">=</span> <span class="mi">2</span>
</span><span id="Simulation.deplacement_boids_simplifie-214"><a href="#Simulation.deplacement_boids_simplifie-214"><span class="linenos">214</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="Simulation.deplacement_boids_simplifie-215"><a href="#Simulation.deplacement_boids_simplifie-215"><span class="linenos">215</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="n">personne</span><span class="o">.</span><span class="n">position</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">personne</span><span class="o">.</span><span class="n">direction</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">pas</span>
</span><span id="Simulation.deplacement_boids_simplifie-216"><a href="#Simulation.deplacement_boids_simplifie-216"><span class="linenos">216</span></a>            <span class="n">x</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">largeur</span><span class="p">)</span>
</span><span id="Simulation.deplacement_boids_simplifie-217"><a href="#Simulation.deplacement_boids_simplifie-217"><span class="linenos">217</span></a>            <span class="n">y</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">hauteur</span><span class="p">)</span>
</span><span id="Simulation.deplacement_boids_simplifie-218"><a href="#Simulation.deplacement_boids_simplifie-218"><span class="linenos">218</span></a>            <span class="n">nouvelle_positions</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">])</span>
</span><span id="Simulation.deplacement_boids_simplifie-219"><a href="#Simulation.deplacement_boids_simplifie-219"><span class="linenos">219</span></a>        <span class="k">for</span> <span class="n">personne</span><span class="p">,</span> <span class="n">position</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">,</span> <span class="n">nouvelle_positions</span><span class="p">):</span>
</span><span id="Simulation.deplacement_boids_simplifie-220"><a href="#Simulation.deplacement_boids_simplifie-220"><span class="linenos">220</span></a>            <span class="n">personne</span><span class="o">.</span><span class="n">se_deplace</span><span class="p">(</span><span class="n">position</span><span class="p">)</span>
</span><span id="Simulation.deplacement_boids_simplifie-221"><a href="#Simulation.deplacement_boids_simplifie-221"><span class="linenos">221</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Cette méthode met à jour la direction des personnes en utilisant deux des trois principes de Boids.
D'abord, on calcule un point moyen des voisins proches pour ajuster légèrement la direction vers ce point.
Ensuite, on ajoute une force de répulsion si des voisins sont trop proches pour éviter qu'ils se stackent.
On ajoute aussi une petite valeur aléatoire pour modifier légèrement la direction à chaque étape.
Enfin, on applique un poids aux murs pour qu'ils qui poussent les personnes vers l'intérieur lorsqu'elles s'approchent trop pour éviter les regroupement contre les murs.</p>
</div>


                            </div>
                            <div id="Simulation.naissance" class="classattr">
                                        <input id="Simulation.naissance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">naissance</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span>, </span><span class="param"><span class="n">nb_nouvelles_personnes</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simulation.naissance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.naissance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.naissance-223"><a href="#Simulation.naissance-223"><span class="linenos">223</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">naissance</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nb_nouvelles_personnes</span><span class="p">):</span>
</span><span id="Simulation.naissance-224"><a href="#Simulation.naissance-224"><span class="linenos">224</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation.naissance-225"><a href="#Simulation.naissance-225"><span class="linenos">225</span></a><span class="sd">        Cette méthode permet d&#39;ajouter de nouvelles personnes à la simulation.</span>
</span><span id="Simulation.naissance-226"><a href="#Simulation.naissance-226"><span class="linenos">226</span></a><span class="sd">        Le nombre de personnes à créer est donné en paramètre. </span>
</span><span id="Simulation.naissance-227"><a href="#Simulation.naissance-227"><span class="linenos">227</span></a><span class="sd">        Une fois les personnes ajoutées, la grille est reconstruite pour mettre à jour la répartition des personnes.</span>
</span><span id="Simulation.naissance-228"><a href="#Simulation.naissance-228"><span class="linenos">228</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.naissance-229"><a href="#Simulation.naissance-229"><span class="linenos">229</span></a>        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nb_nouvelles_personnes</span><span class="p">):</span>
</span><span id="Simulation.naissance-230"><a href="#Simulation.naissance-230"><span class="linenos">230</span></a>            <span class="n">position</span> <span class="o">=</span> <span class="p">[</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">largeur_fenetre</span><span class="p">),</span> <span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">hauteur_fenetre</span><span class="p">)]</span>
</span><span id="Simulation.naissance-231"><a href="#Simulation.naissance-231"><span class="linenos">231</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">pourcentage_immunodeprimes</span><span class="p">:</span>
</span><span id="Simulation.naissance-232"><a href="#Simulation.naissance-232"><span class="linenos">232</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;oui&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="Simulation.naissance-233"><a href="#Simulation.naissance-233"><span class="linenos">233</span></a>            <span class="k">else</span> <span class="p">:</span>
</span><span id="Simulation.naissance-234"><a href="#Simulation.naissance-234"><span class="linenos">234</span></a>                <span class="n">personne</span> <span class="o">=</span> <span class="n">Personne</span><span class="p">(</span><span class="n">etat</span><span class="o">=</span><span class="s2">&quot;sain&quot;</span><span class="p">,</span> <span class="n">immunodeprime</span><span class="o">=</span><span class="s2">&quot;non&quot;</span><span class="p">,</span> <span class="n">position</span><span class="o">=</span><span class="n">position</span><span class="p">,</span> <span class="nb">id</span><span class="o">=</span><span class="n">i</span><span class="p">)</span>
</span><span id="Simulation.naissance-235"><a href="#Simulation.naissance-235"><span class="linenos">235</span></a>            <span class="k">if</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">5</span><span class="p">:</span>
</span><span id="Simulation.naissance-236"><a href="#Simulation.naissance-236"><span class="linenos">236</span></a>                <span class="n">personne</span><span class="o">.</span><span class="n">etre_medecin</span><span class="p">()</span>
</span><span id="Simulation.naissance-237"><a href="#Simulation.naissance-237"><span class="linenos">237</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="Simulation.naissance-238"><a href="#Simulation.naissance-238"><span class="linenos">238</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">construire_grille</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Cette méthode permet d'ajouter de nouvelles personnes à la simulation.
Le nombre de personnes à créer est donné en paramètre. 
Une fois les personnes ajoutées, la grille est reconstruite pour mettre à jour la répartition des personnes.</p>
</div>


                            </div>
                            <div id="Simulation.mise_a_jour_iteration" class="classattr">
                                        <input id="Simulation.mise_a_jour_iteration-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">mise_a_jour_iteration</span><span class="signature pdoc-code condensed">(<span class="param"><span class="bp">self</span></span><span class="return-annotation">):</span></span>

                <label class="view-source-button" for="Simulation.mise_a_jour_iteration-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#Simulation.mise_a_jour_iteration"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="Simulation.mise_a_jour_iteration-240"><a href="#Simulation.mise_a_jour_iteration-240"><span class="linenos">240</span></a>    <span class="k">def</span><span class="w"> </span><span class="nf">mise_a_jour_iteration</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
</span><span id="Simulation.mise_a_jour_iteration-241"><a href="#Simulation.mise_a_jour_iteration-241"><span class="linenos">241</span></a><span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="Simulation.mise_a_jour_iteration-242"><a href="#Simulation.mise_a_jour_iteration-242"><span class="linenos">242</span></a><span class="sd">        On met à jour après chaque itération.</span>
</span><span id="Simulation.mise_a_jour_iteration-243"><a href="#Simulation.mise_a_jour_iteration-243"><span class="linenos">243</span></a><span class="sd">        La mise à jour de la position des personnes suit l&#39;approche de Boids simplifié..</span>
</span><span id="Simulation.mise_a_jour_iteration-244"><a href="#Simulation.mise_a_jour_iteration-244"><span class="linenos">244</span></a><span class="sd">        Ensuite, on reconstruit la grille avec les nouvelles positions, on propage l&#39;infection et on met à jour les états pour chaque personne.</span>
</span><span id="Simulation.mise_a_jour_iteration-245"><a href="#Simulation.mise_a_jour_iteration-245"><span class="linenos">245</span></a><span class="sd">        Pour les calculs, on va estimer que les personnes immunodéprimées ont deux fois plus de chances de mourir.</span>
</span><span id="Simulation.mise_a_jour_iteration-246"><a href="#Simulation.mise_a_jour_iteration-246"><span class="linenos">246</span></a><span class="sd">        Si la personne n&#39;a pas une maladie permanente et qu&#39;elle a survécu à toutes les itérations nécessaires pour que la maladie passe, la personne est guérie.</span>
</span><span id="Simulation.mise_a_jour_iteration-247"><a href="#Simulation.mise_a_jour_iteration-247"><span class="linenos">247</span></a><span class="sd">        Si on est immunisé après la maladie, la personne gagne ce statut, sinon elle est juste saine à nouveau.</span>
</span><span id="Simulation.mise_a_jour_iteration-248"><a href="#Simulation.mise_a_jour_iteration-248"><span class="linenos">248</span></a><span class="sd">        Finalement, on enregistre les statistiques actuelles sous forme de dataframe en calculant le nombre de personnes par état.</span>
</span><span id="Simulation.mise_a_jour_iteration-249"><a href="#Simulation.mise_a_jour_iteration-249"><span class="linenos">249</span></a><span class="sd">        &quot;&quot;&quot;</span>
</span><span id="Simulation.mise_a_jour_iteration-250"><a href="#Simulation.mise_a_jour_iteration-250"><span class="linenos">250</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">deplacement_boids_simplifie</span><span class="p">()</span>
</span><span id="Simulation.mise_a_jour_iteration-251"><a href="#Simulation.mise_a_jour_iteration-251"><span class="linenos">251</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">propager_infection</span><span class="p">()</span>
</span><span id="Simulation.mise_a_jour_iteration-252"><a href="#Simulation.mise_a_jour_iteration-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-253"><a href="#Simulation.mise_a_jour_iteration-253"><span class="linenos">253</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Simulation.mise_a_jour_iteration-254"><a href="#Simulation.mise_a_jour_iteration-254"><span class="linenos">254</span></a>        <span class="k">else</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-255"><a href="#Simulation.mise_a_jour_iteration-255"><span class="linenos">255</span></a>            <span class="n">nb_total</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">iloc</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</span><span id="Simulation.mise_a_jour_iteration-256"><a href="#Simulation.mise_a_jour_iteration-256"><span class="linenos">256</span></a>            <span class="n">nb_naissance</span> <span class="o">=</span> <span class="n">math</span><span class="o">.</span><span class="n">ceil</span><span class="p">(</span><span class="n">nb_total</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">taux_naissance</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-257"><a href="#Simulation.mise_a_jour_iteration-257"><span class="linenos">257</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">naissance</span><span class="p">(</span><span class="n">nb_naissance</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-258"><a href="#Simulation.mise_a_jour_iteration-258"><span class="linenos">258</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">cooldown_avant_naissance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">duree_cooldown_avant_naissance</span>
</span><span id="Simulation.mise_a_jour_iteration-259"><a href="#Simulation.mise_a_jour_iteration-259"><span class="linenos">259</span></a>
</span><span id="Simulation.mise_a_jour_iteration-260"><a href="#Simulation.mise_a_jour_iteration-260"><span class="linenos">260</span></a>        <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-261"><a href="#Simulation.mise_a_jour_iteration-261"><span class="linenos">261</span></a>            <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-262"><a href="#Simulation.mise_a_jour_iteration-262"><span class="linenos">262</span></a>                <span class="n">voisins</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">grille</span><span class="o">.</span><span class="n">voisins_de_personne</span><span class="p">(</span><span class="n">personne</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-263"><a href="#Simulation.mise_a_jour_iteration-263"><span class="linenos">263</span></a>                <span class="n">medecin_autour</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.mise_a_jour_iteration-264"><a href="#Simulation.mise_a_jour_iteration-264"><span class="linenos">264</span></a>                <span class="k">for</span> <span class="n">voisin</span> <span class="ow">in</span> <span class="n">voisins</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-265"><a href="#Simulation.mise_a_jour_iteration-265"><span class="linenos">265</span></a>                    <span class="k">if</span> <span class="n">voisin</span><span class="o">.</span><span class="n">medecin</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">voisin</span><span class="o">.</span><span class="n">etat</span> <span class="o">!=</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-266"><a href="#Simulation.mise_a_jour_iteration-266"><span class="linenos">266</span></a>                        <span class="n">medecin_autour</span> <span class="o">=</span> <span class="mi">1</span>
</span><span id="Simulation.mise_a_jour_iteration-267"><a href="#Simulation.mise_a_jour_iteration-267"><span class="linenos">267</span></a>
</span><span id="Simulation.mise_a_jour_iteration-268"><a href="#Simulation.mise_a_jour_iteration-268"><span class="linenos">268</span></a>                <span class="n">risque_mort</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">taux_letalite</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-269"><a href="#Simulation.mise_a_jour_iteration-269"><span class="linenos">269</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">immunodeprime</span> <span class="o">==</span> <span class="s2">&quot;oui&quot;</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-270"><a href="#Simulation.mise_a_jour_iteration-270"><span class="linenos">270</span></a>                    <span class="n">risque_mort</span> <span class="o">*=</span> <span class="mf">1.2</span>
</span><span id="Simulation.mise_a_jour_iteration-271"><a href="#Simulation.mise_a_jour_iteration-271"><span class="linenos">271</span></a>                <span class="k">if</span> <span class="n">medecin_autour</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-272"><a href="#Simulation.mise_a_jour_iteration-272"><span class="linenos">272</span></a>                    <span class="n">risque_mort</span> <span class="o">/=</span> <span class="mi">2</span>
</span><span id="Simulation.mise_a_jour_iteration-273"><a href="#Simulation.mise_a_jour_iteration-273"><span class="linenos">273</span></a>                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">risque_mort</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-274"><a href="#Simulation.mise_a_jour_iteration-274"><span class="linenos">274</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">mourir</span><span class="p">()</span>
</span><span id="Simulation.mise_a_jour_iteration-275"><a href="#Simulation.mise_a_jour_iteration-275"><span class="linenos">275</span></a>                    <span class="k">continue</span>
</span><span id="Simulation.mise_a_jour_iteration-276"><a href="#Simulation.mise_a_jour_iteration-276"><span class="linenos">276</span></a>
</span><span id="Simulation.mise_a_jour_iteration-277"><a href="#Simulation.mise_a_jour_iteration-277"><span class="linenos">277</span></a>                <span class="k">if</span> <span class="n">medecin_autour</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-278"><a href="#Simulation.mise_a_jour_iteration-278"><span class="linenos">278</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="Simulation.mise_a_jour_iteration-279"><a href="#Simulation.mise_a_jour_iteration-279"><span class="linenos">279</span></a>                <span class="k">else</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-280"><a href="#Simulation.mise_a_jour_iteration-280"><span class="linenos">280</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation.mise_a_jour_iteration-281"><a href="#Simulation.mise_a_jour_iteration-281"><span class="linenos">281</span></a>
</span><span id="Simulation.mise_a_jour_iteration-282"><a href="#Simulation.mise_a_jour_iteration-282"><span class="linenos">282</span></a>                <span class="n">aleatoire</span> <span class="o">=</span> <span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">5</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-283"><a href="#Simulation.mise_a_jour_iteration-283"><span class="linenos">283</span></a>                <span class="k">if</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-284"><a href="#Simulation.mise_a_jour_iteration-284"><span class="linenos">284</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">2</span>
</span><span id="Simulation.mise_a_jour_iteration-285"><a href="#Simulation.mise_a_jour_iteration-285"><span class="linenos">285</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-286"><a href="#Simulation.mise_a_jour_iteration-286"><span class="linenos">286</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation.mise_a_jour_iteration-287"><a href="#Simulation.mise_a_jour_iteration-287"><span class="linenos">287</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">2</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-288"><a href="#Simulation.mise_a_jour_iteration-288"><span class="linenos">288</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Simulation.mise_a_jour_iteration-289"><a href="#Simulation.mise_a_jour_iteration-289"><span class="linenos">289</span></a>                <span class="k">elif</span> <span class="n">aleatoire</span> <span class="o">==</span> <span class="mi">3</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-290"><a href="#Simulation.mise_a_jour_iteration-290"><span class="linenos">290</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">-=</span> <span class="mi">2</span>
</span><span id="Simulation.mise_a_jour_iteration-291"><a href="#Simulation.mise_a_jour_iteration-291"><span class="linenos">291</span></a>
</span><span id="Simulation.mise_a_jour_iteration-292"><a href="#Simulation.mise_a_jour_iteration-292"><span class="linenos">292</span></a>                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span> <span class="o">!=</span> <span class="o">-</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">&gt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-293"><a href="#Simulation.mise_a_jour_iteration-293"><span class="linenos">293</span></a>                    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">immunite_apres_guerison</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-294"><a href="#Simulation.mise_a_jour_iteration-294"><span class="linenos">294</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">etre_immunise</span><span class="p">()</span>
</span><span id="Simulation.mise_a_jour_iteration-295"><a href="#Simulation.mise_a_jour_iteration-295"><span class="linenos">295</span></a>                    <span class="k">else</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-296"><a href="#Simulation.mise_a_jour_iteration-296"><span class="linenos">296</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">guerir</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-297"><a href="#Simulation.mise_a_jour_iteration-297"><span class="linenos">297</span></a>                        <span class="n">personne</span><span class="o">.</span><span class="n">cpt_iterations_infection</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.mise_a_jour_iteration-298"><a href="#Simulation.mise_a_jour_iteration-298"><span class="linenos">298</span></a>                    <span class="k">continue</span>
</span><span id="Simulation.mise_a_jour_iteration-299"><a href="#Simulation.mise_a_jour_iteration-299"><span class="linenos">299</span></a>            <span class="k">elif</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s1">&#39;sain&#39;</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-300"><a href="#Simulation.mise_a_jour_iteration-300"><span class="linenos">300</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-301"><a href="#Simulation.mise_a_jour_iteration-301"><span class="linenos">301</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Simulation.mise_a_jour_iteration-302"><a href="#Simulation.mise_a_jour_iteration-302"><span class="linenos">302</span></a>            <span class="k">elif</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s1">&#39;mort&#39;</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-303"><a href="#Simulation.mise_a_jour_iteration-303"><span class="linenos">303</span></a>                <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_affichage_apres_mort</span> <span class="o">&gt;=</span> <span class="mi">1</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-304"><a href="#Simulation.mise_a_jour_iteration-304"><span class="linenos">304</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_affichage_apres_mort</span> <span class="o">-=</span> <span class="mi">1</span>
</span><span id="Simulation.mise_a_jour_iteration-305"><a href="#Simulation.mise_a_jour_iteration-305"><span class="linenos">305</span></a>        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">&gt;=</span> <span class="mi">200</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-306"><a href="#Simulation.mise_a_jour_iteration-306"><span class="linenos">306</span></a>            <span class="n">quantite_infectes_relance</span> <span class="o">=</span> <span class="mi">5</span>
</span><span id="Simulation.mise_a_jour_iteration-307"><a href="#Simulation.mise_a_jour_iteration-307"><span class="linenos">307</span></a>            <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-308"><a href="#Simulation.mise_a_jour_iteration-308"><span class="linenos">308</span></a>                <span class="k">if</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">quantite_infectes_relance</span> <span class="ow">and</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">!=</span> <span class="s2">&quot;mort&quot;</span><span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-309"><a href="#Simulation.mise_a_jour_iteration-309"><span class="linenos">309</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">etre_infecte</span><span class="p">()</span>
</span><span id="Simulation.mise_a_jour_iteration-310"><a href="#Simulation.mise_a_jour_iteration-310"><span class="linenos">310</span></a>                    <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="Simulation.mise_a_jour_iteration-311"><a href="#Simulation.mise_a_jour_iteration-311"><span class="linenos">311</span></a>                    <span class="n">personne</span><span class="o">.</span><span class="n">cooldown_immunite</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">maladie</span><span class="o">.</span><span class="n">temps_guerison</span><span class="o">*</span><span class="mf">0.75</span>
</span><span id="Simulation.mise_a_jour_iteration-312"><a href="#Simulation.mise_a_jour_iteration-312"><span class="linenos">312</span></a>        <span class="n">nb_morts</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;mort&quot;</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-313"><a href="#Simulation.mise_a_jour_iteration-313"><span class="linenos">313</span></a>        <span class="n">nb_infectes</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">(</span><span class="mi">1</span> <span class="k">for</span> <span class="n">personne</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span> <span class="k">if</span> <span class="n">personne</span><span class="o">.</span><span class="n">etat</span> <span class="o">==</span> <span class="s2">&quot;infecte&quot;</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-314"><a href="#Simulation.mise_a_jour_iteration-314"><span class="linenos">314</span></a>        <span class="n">nb_total</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">liste_personnes</span><span class="p">)</span>
</span><span id="Simulation.mise_a_jour_iteration-315"><a href="#Simulation.mise_a_jour_iteration-315"><span class="linenos">315</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">df_historique</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">iterations</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">nb_morts</span><span class="p">,</span> <span class="n">nb_total</span><span class="p">]</span>
</span><span id="Simulation.mise_a_jour_iteration-316"><a href="#Simulation.mise_a_jour_iteration-316"><span class="linenos">316</span></a>        <span class="k">if</span> <span class="n">nb_infectes</span> <span class="o">==</span> <span class="mi">0</span> <span class="p">:</span>
</span><span id="Simulation.mise_a_jour_iteration-317"><a href="#Simulation.mise_a_jour_iteration-317"><span class="linenos">317</span></a>            <span class="bp">self</span><span class="o">.</span><span class="n">iterations_sans_infecte</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="Simulation.mise_a_jour_iteration-318"><a href="#Simulation.mise_a_jour_iteration-318"><span class="linenos">318</span></a>        <span class="bp">self</span><span class="o">.</span><span class="n">iterations</span> <span class="o">+=</span> <span class="mi">1</span>
</span></pre></div>


            <div class="docstring"><p>On met à jour après chaque itération.
La mise à jour de la position des personnes suit l'approche de Boids simplifié..
Ensuite, on reconstruit la grille avec les nouvelles positions, on propage l'infection et on met à jour les états pour chaque personne.
Pour les calculs, on va estimer que les personnes immunodéprimées ont deux fois plus de chances de mourir.
Si la personne n'a pas une maladie permanente et qu'elle a survécu à toutes les itérations nécessaires pour que la maladie passe, la personne est guérie.
Si on est immunisé après la maladie, la personne gagne ce statut, sinon elle est juste saine à nouveau.
Finalement, on enregistre les statistiques actuelles sous forme de dataframe en calculant le nombre de personnes par état.</p>
</div>


                            </div>
                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>